
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.21">
    
    
      
        <title>About - MYNotebook</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.66ac8b77.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="MYNotebook" class="md-header__button md-logo" aria-label="MYNotebook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MYNotebook
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              About
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="MYNotebook" class="md-nav__button md-logo" aria-label="MYNotebook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    MYNotebook
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    About
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#os-ok" class="md-nav__link">
    <span class="md-ellipsis">
      OS 导论:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OS 导论:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure" class="md-nav__link">
    <span class="md-ellipsis">
      Structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#operating-system-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Operating-System Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operating-system-operation" class="md-nav__link">
    <span class="md-ellipsis">
      Operating-System Operation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#main-parts" class="md-nav__link">
    <span class="md-ellipsis">
      Main parts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Main parts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#process-management" class="md-nav__link">
    <span class="md-ellipsis">
      Process Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#memory-management" class="md-nav__link">
    <span class="md-ellipsis">
      Memory Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storage-management" class="md-nav__link">
    <span class="md-ellipsis">
      Storage Management
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#os-structuresok" class="md-nav__link">
    <span class="md-ellipsis">
      OS Structures:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OS Structures:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#os-services" class="md-nav__link">
    <span class="md-ellipsis">
      OS Services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-call" class="md-nav__link">
    <span class="md-ellipsis">
      System call
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      系统程序
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#os" class="md-nav__link">
    <span class="md-ellipsis">
      OS 设计和实现
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#os_1" class="md-nav__link">
    <span class="md-ellipsis">
      OS 结构
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virtual-machine" class="md-nav__link">
    <span class="md-ellipsis">
      Virtual Machine
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#os-startup" class="md-nav__link">
    <span class="md-ellipsis">
      OS Startup
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#processesok" class="md-nav__link">
    <span class="md-ellipsis">
      Processes:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Processes:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#process-concept" class="md-nav__link">
    <span class="md-ellipsis">
      Process Concept
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      Process Scheduling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-operation" class="md-nav__link">
    <span class="md-ellipsis">
      Process Operation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cooperating-processes" class="md-nav__link">
    <span class="md-ellipsis">
      Cooperating Processes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#communicatonipc" class="md-nav__link">
    <span class="md-ellipsis">
      Communicaton(IPC)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#threadsok" class="md-nav__link">
    <span class="md-ellipsis">
      Threads:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Threads:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview_1" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-thread" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-thread
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Multi-thread">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      线程的好处
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-threads" class="md-nav__link">
    <span class="md-ellipsis">
      User Threads
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kernel-threads" class="md-nav__link">
    <span class="md-ellipsis">
      Kernel Threads
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      映射模型
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#threading-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Threading Issues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Threading Issues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      语义的变化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      线程取消
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      信号处理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      线程池
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      特定数据
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      调度激活
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cpu-schedulingok" class="md-nav__link">
    <span class="md-ellipsis">
      CPU Scheduling:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CPU Scheduling:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Concepts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scheduling-criteria" class="md-nav__link">
    <span class="md-ellipsis">
      Scheduling Criteria
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scheduling-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      Scheduling Algorithms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Scheduling Algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fcfs" class="md-nav__link">
    <span class="md-ellipsis">
      FCFS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sjf" class="md-nav__link">
    <span class="md-ellipsis">
      SJF
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#priority-scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      Priority Scheduling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#round-robin-rr" class="md-nav__link">
    <span class="md-ellipsis">
      Round Robin (RR)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      多级队列
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      多级反馈队列
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      多处理器调度
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#real-time-schedule" class="md-nav__link">
    <span class="md-ellipsis">
      Real-Time Schedule
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thread-shceduling" class="md-nav__link">
    <span class="md-ellipsis">
      Thread Shceduling
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#process-synchronizationok" class="md-nav__link">
    <span class="md-ellipsis">
      Process Synchronization:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Process Synchronization:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic" class="md-nav__link">
    <span class="md-ellipsis">
      Basic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      软件机制
    </span>
  </a>
  
    <nav class="md-nav" aria-label="软件机制">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      单标志法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      双标志后检查法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      双标志先检查法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#petersons-solutionimp" class="md-nav__link">
    <span class="md-ellipsis">
      Peterson's Solution:imp:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#swap" class="md-nav__link">
    <span class="md-ellipsis">
      Swap 指令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cas" class="md-nav__link">
    <span class="md-ellipsis">
      CAS 指令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mutex" class="md-nav__link">
    <span class="md-ellipsis">
      Mutex 锁
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#imp" class="md-nav__link">
    <span class="md-ellipsis">
      信号量机制:imp:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      管程机制
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deadlocksok" class="md-nav__link">
    <span class="md-ellipsis">
      Deadlocks:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deadlocks:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deadlock-characterization" class="md-nav__link">
    <span class="md-ellipsis">
      Deadlock Characterization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deadlock-prevention" class="md-nav__link">
    <span class="md-ellipsis">
      Deadlock Prevention
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deadlock-avoidance" class="md-nav__link">
    <span class="md-ellipsis">
      Deadlock Avoidance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deadlock-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Deadlock Detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recovery-from-deadlock" class="md-nav__link">
    <span class="md-ellipsis">
      Recovery from Deadlock
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#main-memoryok" class="md-nav__link">
    <span class="md-ellipsis">
      Main Memory:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Main Memory:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    <span class="md-ellipsis">
      Background
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      程序运行过程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      连续内存分配
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagingimp" class="md-nav__link">
    <span class="md-ellipsis">
      分页 Paging:imp:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      页表结构
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#segmentation" class="md-nav__link">
    <span class="md-ellipsis">
      分段 Segmentation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#virtual-memoryok" class="md-nav__link">
    <span class="md-ellipsis">
      Virtual Memory:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Virtual Memory:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#background_1" class="md-nav__link">
    <span class="md-ellipsis">
      Background
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#demand-pagingimp" class="md-nav__link">
    <span class="md-ellipsis">
      Demand Paging:imp:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Demand Paging:imp:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      进程创建
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#page-replacement" class="md-nav__link">
    <span class="md-ellipsis">
      Page Replacement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allocation-of-frames" class="md-nav__link">
    <span class="md-ellipsis">
      Allocation of Frames
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thrashing" class="md-nav__link">
    <span class="md-ellipsis">
      Thrashing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allocating-kernel-memory" class="md-nav__link">
    <span class="md-ellipsis">
      Allocating Kernel Memory
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-system-interfaceok" class="md-nav__link">
    <span class="md-ellipsis">
      File System Interface:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File System Interface:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Concepts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Access Methods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#directory-structureimp" class="md-nav__link">
    <span class="md-ellipsis">
      Directory Structure:imp:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-system-mounting" class="md-nav__link">
    <span class="md-ellipsis">
      File-System Mounting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-sharing" class="md-nav__link">
    <span class="md-ellipsis">
      File Sharing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protection" class="md-nav__link">
    <span class="md-ellipsis">
      Protection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-system-implementationok" class="md-nav__link">
    <span class="md-ellipsis">
      File System Implementation:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File System Implementation:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-system-structure" class="md-nav__link">
    <span class="md-ellipsis">
      File-System Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virtual-file-system" class="md-nav__link">
    <span class="md-ellipsis">
      Virtual File System
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#directory-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Directory Implementation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allocation-methodsimp" class="md-nav__link">
    <span class="md-ellipsis">
      Allocation Methods:imp:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#free-space-management" class="md-nav__link">
    <span class="md-ellipsis">
      Free Space Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#efficiency-and-performance" class="md-nav__link">
    <span class="md-ellipsis">
      Efficiency and Performance??
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mass-storage-systemsok" class="md-nav__link">
    <span class="md-ellipsis">
      Mass-Storage Systems:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Mass-Storage Systems:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure-attachment" class="md-nav__link">
    <span class="md-ellipsis">
      Structure &amp; Attachment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#imp_1" class="md-nav__link">
    <span class="md-ellipsis">
      磁盘调度:imp:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disk-management" class="md-nav__link">
    <span class="md-ellipsis">
      Disk Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#swap-space-management" class="md-nav__link">
    <span class="md-ellipsis">
      Swap-Space Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#raid" class="md-nav__link">
    <span class="md-ellipsis">
      RAID 结构
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#io-systemsok" class="md-nav__link">
    <span class="md-ellipsis">
      I/O Systems:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="I/O Systems:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hardware" class="md-nav__link">
    <span class="md-ellipsis">
      Hardware
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-io-interface" class="md-nav__link">
    <span class="md-ellipsis">
      Application IO Interface
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kernel-io-subsystem" class="md-nav__link">
    <span class="md-ellipsis">
      Kernel IO Subsystem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io" class="md-nav__link">
    <span class="md-ellipsis">
      内核IO子系统
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io-request" class="md-nav__link">
    <span class="md-ellipsis">
      IO Request
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance" class="md-nav__link">
    <span class="md-ellipsis">
      Performance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      考试介绍
    </span>
  </a>
  
    <nav class="md-nav" aria-label="考试介绍">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      待办事项
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#os-ok" class="md-nav__link">
    <span class="md-ellipsis">
      OS 导论:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OS 导论:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure" class="md-nav__link">
    <span class="md-ellipsis">
      Structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#operating-system-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Operating-System Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operating-system-operation" class="md-nav__link">
    <span class="md-ellipsis">
      Operating-System Operation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#main-parts" class="md-nav__link">
    <span class="md-ellipsis">
      Main parts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Main parts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#process-management" class="md-nav__link">
    <span class="md-ellipsis">
      Process Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#memory-management" class="md-nav__link">
    <span class="md-ellipsis">
      Memory Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storage-management" class="md-nav__link">
    <span class="md-ellipsis">
      Storage Management
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#os-structuresok" class="md-nav__link">
    <span class="md-ellipsis">
      OS Structures:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OS Structures:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#os-services" class="md-nav__link">
    <span class="md-ellipsis">
      OS Services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-call" class="md-nav__link">
    <span class="md-ellipsis">
      System call
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      系统程序
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#os" class="md-nav__link">
    <span class="md-ellipsis">
      OS 设计和实现
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#os_1" class="md-nav__link">
    <span class="md-ellipsis">
      OS 结构
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virtual-machine" class="md-nav__link">
    <span class="md-ellipsis">
      Virtual Machine
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#os-startup" class="md-nav__link">
    <span class="md-ellipsis">
      OS Startup
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#processesok" class="md-nav__link">
    <span class="md-ellipsis">
      Processes:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Processes:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#process-concept" class="md-nav__link">
    <span class="md-ellipsis">
      Process Concept
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      Process Scheduling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#process-operation" class="md-nav__link">
    <span class="md-ellipsis">
      Process Operation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cooperating-processes" class="md-nav__link">
    <span class="md-ellipsis">
      Cooperating Processes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#communicatonipc" class="md-nav__link">
    <span class="md-ellipsis">
      Communicaton(IPC)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#threadsok" class="md-nav__link">
    <span class="md-ellipsis">
      Threads:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Threads:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview_1" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-thread" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-thread
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Multi-thread">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      线程的好处
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-threads" class="md-nav__link">
    <span class="md-ellipsis">
      User Threads
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kernel-threads" class="md-nav__link">
    <span class="md-ellipsis">
      Kernel Threads
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      映射模型
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#threading-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Threading Issues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Threading Issues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      语义的变化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      线程取消
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      信号处理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      线程池
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      特定数据
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      调度激活
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cpu-schedulingok" class="md-nav__link">
    <span class="md-ellipsis">
      CPU Scheduling:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CPU Scheduling:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Concepts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scheduling-criteria" class="md-nav__link">
    <span class="md-ellipsis">
      Scheduling Criteria
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scheduling-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      Scheduling Algorithms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Scheduling Algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fcfs" class="md-nav__link">
    <span class="md-ellipsis">
      FCFS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sjf" class="md-nav__link">
    <span class="md-ellipsis">
      SJF
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#priority-scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      Priority Scheduling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#round-robin-rr" class="md-nav__link">
    <span class="md-ellipsis">
      Round Robin (RR)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      多级队列
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      多级反馈队列
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      多处理器调度
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#real-time-schedule" class="md-nav__link">
    <span class="md-ellipsis">
      Real-Time Schedule
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thread-shceduling" class="md-nav__link">
    <span class="md-ellipsis">
      Thread Shceduling
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#process-synchronizationok" class="md-nav__link">
    <span class="md-ellipsis">
      Process Synchronization:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Process Synchronization:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic" class="md-nav__link">
    <span class="md-ellipsis">
      Basic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      软件机制
    </span>
  </a>
  
    <nav class="md-nav" aria-label="软件机制">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      单标志法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      双标志后检查法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      双标志先检查法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#petersons-solutionimp" class="md-nav__link">
    <span class="md-ellipsis">
      Peterson's Solution:imp:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#swap" class="md-nav__link">
    <span class="md-ellipsis">
      Swap 指令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cas" class="md-nav__link">
    <span class="md-ellipsis">
      CAS 指令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mutex" class="md-nav__link">
    <span class="md-ellipsis">
      Mutex 锁
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#imp" class="md-nav__link">
    <span class="md-ellipsis">
      信号量机制:imp:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      管程机制
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deadlocksok" class="md-nav__link">
    <span class="md-ellipsis">
      Deadlocks:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deadlocks:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deadlock-characterization" class="md-nav__link">
    <span class="md-ellipsis">
      Deadlock Characterization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deadlock-prevention" class="md-nav__link">
    <span class="md-ellipsis">
      Deadlock Prevention
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deadlock-avoidance" class="md-nav__link">
    <span class="md-ellipsis">
      Deadlock Avoidance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deadlock-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Deadlock Detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recovery-from-deadlock" class="md-nav__link">
    <span class="md-ellipsis">
      Recovery from Deadlock
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#main-memoryok" class="md-nav__link">
    <span class="md-ellipsis">
      Main Memory:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Main Memory:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    <span class="md-ellipsis">
      Background
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      程序运行过程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      连续内存分配
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pagingimp" class="md-nav__link">
    <span class="md-ellipsis">
      分页 Paging:imp:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      页表结构
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#segmentation" class="md-nav__link">
    <span class="md-ellipsis">
      分段 Segmentation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#virtual-memoryok" class="md-nav__link">
    <span class="md-ellipsis">
      Virtual Memory:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Virtual Memory:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#background_1" class="md-nav__link">
    <span class="md-ellipsis">
      Background
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#demand-pagingimp" class="md-nav__link">
    <span class="md-ellipsis">
      Demand Paging:imp:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Demand Paging:imp:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      进程创建
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#page-replacement" class="md-nav__link">
    <span class="md-ellipsis">
      Page Replacement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allocation-of-frames" class="md-nav__link">
    <span class="md-ellipsis">
      Allocation of Frames
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thrashing" class="md-nav__link">
    <span class="md-ellipsis">
      Thrashing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allocating-kernel-memory" class="md-nav__link">
    <span class="md-ellipsis">
      Allocating Kernel Memory
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-system-interfaceok" class="md-nav__link">
    <span class="md-ellipsis">
      File System Interface:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File System Interface:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Concepts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Access Methods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#directory-structureimp" class="md-nav__link">
    <span class="md-ellipsis">
      Directory Structure:imp:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-system-mounting" class="md-nav__link">
    <span class="md-ellipsis">
      File-System Mounting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-sharing" class="md-nav__link">
    <span class="md-ellipsis">
      File Sharing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protection" class="md-nav__link">
    <span class="md-ellipsis">
      Protection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#file-system-implementationok" class="md-nav__link">
    <span class="md-ellipsis">
      File System Implementation:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File System Implementation:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-system-structure" class="md-nav__link">
    <span class="md-ellipsis">
      File-System Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virtual-file-system" class="md-nav__link">
    <span class="md-ellipsis">
      Virtual File System
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#directory-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Directory Implementation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allocation-methodsimp" class="md-nav__link">
    <span class="md-ellipsis">
      Allocation Methods:imp:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#free-space-management" class="md-nav__link">
    <span class="md-ellipsis">
      Free Space Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#efficiency-and-performance" class="md-nav__link">
    <span class="md-ellipsis">
      Efficiency and Performance??
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mass-storage-systemsok" class="md-nav__link">
    <span class="md-ellipsis">
      Mass-Storage Systems:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Mass-Storage Systems:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure-attachment" class="md-nav__link">
    <span class="md-ellipsis">
      Structure &amp; Attachment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#imp_1" class="md-nav__link">
    <span class="md-ellipsis">
      磁盘调度:imp:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disk-management" class="md-nav__link">
    <span class="md-ellipsis">
      Disk Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#swap-space-management" class="md-nav__link">
    <span class="md-ellipsis">
      Swap-Space Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#raid" class="md-nav__link">
    <span class="md-ellipsis">
      RAID 结构
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#io-systemsok" class="md-nav__link">
    <span class="md-ellipsis">
      I/O Systems:ok:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="I/O Systems:ok:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hardware" class="md-nav__link">
    <span class="md-ellipsis">
      Hardware
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-io-interface" class="md-nav__link">
    <span class="md-ellipsis">
      Application IO Interface
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kernel-io-subsystem" class="md-nav__link">
    <span class="md-ellipsis">
      Kernel IO Subsystem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io" class="md-nav__link">
    <span class="md-ellipsis">
      内核IO子系统
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io-request" class="md-nav__link">
    <span class="md-ellipsis">
      IO Request
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance" class="md-nav__link">
    <span class="md-ellipsis">
      Performance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      考试介绍
    </span>
  </a>
  
    <nav class="md-nav" aria-label="考试介绍">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      待办事项
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="_1">操作系统</h1>
<div class="toc">
<ul>
<li><a href="#_1">操作系统</a><ul>
<li><a href="#os-ok">OS 导论:ok:</a><ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#structure">Structure</a><ul>
<li><a href="#operating-system-structure">Operating-System Structure</a></li>
<li><a href="#operating-system-operation">Operating-System Operation</a></li>
</ul>
</li>
<li><a href="#main-parts">Main parts</a><ul>
<li><a href="#process-management">Process Management</a></li>
<li><a href="#memory-management">Memory Management</a></li>
<li><a href="#storage-management">Storage Management</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#os-structuresok">OS Structures:ok:</a><ul>
<li><a href="#os-services">OS Services</a></li>
<li><a href="#system-call">System call</a></li>
<li><a href="#_2">系统程序</a></li>
<li><a href="#os">OS 设计和实现</a></li>
<li><a href="#os_1">OS 结构</a></li>
<li><a href="#virtual-machine">Virtual Machine</a></li>
<li><a href="#os-startup">OS Startup</a></li>
</ul>
</li>
<li><a href="#processesok">Processes:ok:</a><ul>
<li><a href="#process-concept">Process Concept</a></li>
<li><a href="#process-scheduling">Process Scheduling</a></li>
<li><a href="#process-operation">Process Operation</a></li>
<li><a href="#cooperating-processes">Cooperating Processes</a></li>
<li><a href="#communicatonipc">Communicaton(IPC)</a></li>
</ul>
</li>
<li><a href="#threadsok">Threads:ok:</a><ul>
<li><a href="#overview_1">Overview</a></li>
<li><a href="#multi-thread">Multi-thread</a><ul>
<li><a href="#_3">线程的好处</a></li>
<li><a href="#user-threads">User Threads</a></li>
<li><a href="#kernel-threads">Kernel Threads</a></li>
<li><a href="#_4">映射模型</a></li>
</ul>
</li>
<li><a href="#threading-issues">Threading Issues</a><ul>
<li><a href="#_5">语义的变化</a></li>
<li><a href="#_6">线程取消</a></li>
<li><a href="#_7">信号处理</a></li>
<li><a href="#_8">线程池</a></li>
<li><a href="#_9">特定数据</a></li>
<li><a href="#_10">调度激活</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#cpu-schedulingok">CPU Scheduling:ok:</a><ul>
<li><a href="#basic-concepts">Basic Concepts</a></li>
<li><a href="#scheduling-criteria">Scheduling Criteria</a></li>
<li><a href="#scheduling-algorithms">Scheduling Algorithms</a><ul>
<li><a href="#fcfs">FCFS</a></li>
<li><a href="#sjf">SJF</a></li>
<li><a href="#priority-scheduling">Priority Scheduling</a></li>
<li><a href="#round-robin-rr">Round Robin (RR)</a></li>
<li><a href="#_11">多级队列</a></li>
<li><a href="#_12">多级反馈队列</a></li>
<li><a href="#_13">多处理器调度</a></li>
</ul>
</li>
<li><a href="#real-time-schedule">Real-Time Schedule</a></li>
<li><a href="#thread-shceduling">Thread Shceduling</a></li>
</ul>
</li>
<li><a href="#process-synchronizationok">Process Synchronization:ok:</a><ul>
<li><a href="#basic">Basic</a></li>
<li><a href="#_14">软件机制</a><ul>
<li><a href="#_15">单标志法</a></li>
<li><a href="#_16">双标志后检查法</a></li>
<li><a href="#_17">双标志先检查法</a></li>
<li><a href="#petersons-solutionimp">Peterson's Solution:imp:</a></li>
<li><a href="#swap">Swap 指令</a></li>
<li><a href="#cas">CAS 指令</a></li>
<li><a href="#mutex">Mutex 锁</a></li>
</ul>
</li>
<li><a href="#imp">信号量机制:imp:</a></li>
<li><a href="#_18">管程机制</a></li>
</ul>
</li>
<li><a href="#deadlocksok">Deadlocks:ok:</a><ul>
<li><a href="#deadlock-characterization">Deadlock Characterization</a></li>
<li><a href="#deadlock-prevention">Deadlock Prevention</a></li>
<li><a href="#deadlock-avoidance">Deadlock Avoidance</a></li>
<li><a href="#deadlock-detection">Deadlock Detection</a></li>
<li><a href="#recovery-from-deadlock">Recovery from Deadlock</a></li>
</ul>
</li>
<li><a href="#main-memoryok">Main Memory:ok:</a><ul>
<li><a href="#background">Background</a></li>
<li><a href="#_19">程序运行过程</a></li>
<li><a href="#_20">连续内存分配</a></li>
<li><a href="#pagingimp">分页 Paging:imp:</a></li>
<li><a href="#_21">页表结构</a></li>
<li><a href="#segmentation">分段 Segmentation</a></li>
</ul>
</li>
<li><a href="#virtual-memoryok">Virtual Memory:ok:</a><ul>
<li><a href="#background_1">Background</a></li>
<li><a href="#demand-pagingimp">Demand Paging:imp:</a><ul>
<li><a href="#_22">进程创建</a></li>
<li><a href="#page-replacement">Page Replacement</a></li>
<li><a href="#allocation-of-frames">Allocation of Frames</a></li>
</ul>
</li>
<li><a href="#thrashing">Thrashing</a></li>
<li><a href="#allocating-kernel-memory">Allocating Kernel Memory</a></li>
</ul>
</li>
<li><a href="#file-system-interfaceok">File System Interface:ok:</a><ul>
<li><a href="#concepts">Concepts</a></li>
<li><a href="#access-methods">Access Methods</a></li>
<li><a href="#directory-structureimp">Directory Structure:imp:</a></li>
<li><a href="#file-system-mounting">File-System Mounting</a></li>
<li><a href="#file-sharing">File Sharing</a></li>
<li><a href="#protection">Protection</a></li>
</ul>
</li>
<li><a href="#file-system-implementationok">File System Implementation:ok:</a><ul>
<li><a href="#file-system-structure">File-System Structure</a></li>
<li><a href="#virtual-file-system">Virtual File System</a></li>
<li><a href="#directory-implementation">Directory Implementation</a></li>
<li><a href="#allocation-methodsimp">Allocation Methods:imp:</a></li>
<li><a href="#free-space-management">Free Space Management</a></li>
<li><a href="#efficiency-and-performance">Efficiency and Performance??</a></li>
</ul>
</li>
<li><a href="#mass-storage-systemsok">Mass-Storage Systems:ok:</a><ul>
<li><a href="#structure-attachment">Structure &amp; Attachment</a></li>
<li><a href="#imp_1">磁盘调度:imp:</a></li>
<li><a href="#disk-management">Disk Management</a></li>
<li><a href="#swap-space-management">Swap-Space Management</a></li>
<li><a href="#raid">RAID 结构</a></li>
</ul>
</li>
<li><a href="#io-systemsok">I/O Systems:ok:</a><ul>
<li><a href="#hardware">Hardware</a></li>
<li><a href="#application-io-interface">Application IO Interface</a></li>
<li><a href="#kernel-io-subsystem">Kernel IO Subsystem</a></li>
<li><a href="#io">内核IO子系统</a></li>
<li><a href="#io-request">IO Request</a></li>
<li><a href="#performance">Performance</a></li>
</ul>
</li>
<li><a href="#_23">考试介绍</a><ul>
<li><a href="#_24">待办事项</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h2 id="os-ok">OS 导论:ok:</h2>
<h3 id="overview">Overview</h3>
<p>Intro</p>
<ul>
<li>
<p>OS Defination: resource allocator + control program</p>
</li>
<li>
<p>kernel: The one program running at all times on the computer  is the <strong>kernel</strong> </p>
</li>
<li>
<p>4 Parts: 用户、应用、系统软件、硬件</p>
</li>
</ul>
<p>Computer System Organization</p>
<ul>
<li>开机运行时，加载引导程序bootstrap：存放在固件 firmwork例如ROM EPROM，定位操作系统kernel并加载到内存</li>
<li>冯诺依曼架构中 最核心的部件是memory</li>
<li><strong>I/O</strong> 结构，IO设备可以和CPU并行，IO设备有<strong>设备控制器</strong>，设备控制器有<strong>local buffer</strong>，CUP 控制主存和local buffer进行数据交换，IO操作来自local buffer，然后设备控制器通过系统总线引起<strong>中断</strong>。</li>
<li><strong>中断vector</strong>：包含所有中断服务例程 ISR 的地址。</li>
<li>中断架构保存中断指令的地址；Incoming interrupts会被disabled，防止当前中断丢失；操作系统是中断驱动的；</li>
<li><strong>Trap</strong>： err 或 useer request/system call引起的中断</li>
<li>Interrupt Handling：通过寄存器和程序计数器；判断类型：轮巡还是系统向量；</li>
<li><strong>两种IO类型</strong> ：<ul>
<li>同步IO Synchronous：IO开始之后其他的操作必须等待这个IO完成才能继续工作，需要等待；</li>
<li>异步IO Asynchronous：IO开始之后，控制权交给用户了，不需要等待这个IO操作完成；
        设备状态表：记录每个IO设备的的信息，使用链表记录；</li>
</ul>
</li>
<li>DMA/直接内存访问：能已接近内存的速度传递信息，用于高速OS设备中，无需CPU，每一块产生一个中断</li>
<li>存储结构</li>
<li>三层结构，按照速度、价格、易失性分类；</li>
<li>Cashing：泛指一种将信息复制到更快存储系统的技术原理，用来解决速度不匹配的情况；</li>
<li>从磁盘到寄存器中间的数据迁移分为两种类型<ul>
<li>多任务Multitasking，注意不同级别数据一致性的问题</li>
<li>多处理器Multiprocessor，注意硬件中cache一致性问题，有SMP架构
        <img alt="image-20240914145825010" src="../OS.assets/image-20240914145825010.png" />
        多核系统Multicore：同一个处理器/芯片上有多个CPU/核心
        <img alt="image-20240914150154165" src="../OS.assets/image-20240914150154165.png" /> 
        NUMA架构：CPU相连，扩展高效但远的CPU慢
        <img alt="image-20240914150408181" src="../OS.assets/image-20240914150408181.png" /> </li>
</ul>
</li>
</ul>
<h3 id="structure">Structure</h3>
<h4 id="operating-system-structure">Operating-System Structure</h4>
<ul>
<li>多道程序设计Multiprogramming：提高效率/CPU利用率。部分任务在内存中，多个任务通过job scheduling选择当前任务；当某个任务等待IO的时候，其他任务可以执行；</li>
<li>分时/多任务Timesharing/Multitasking：交互性好/响应时间低。需要CPU scheduling切换任务，当内存放不下所有的进程可以用swapping或者Virtual memory；</li>
</ul>
<h4 id="operating-system-operation">Operating-System Operation</h4>
<ul>
<li>Interrupt driven by hardware; 
    Software error or request creates exception or trap; 其他问题例如：无限循环、进程间相互修改，两种保护方法</li>
<li>Dual-mode：user mode 和 kernel mode。保护操作系统，用到Mode bit表示不同的模式。</li>
<li>Timmer：用来阻止无限循环和进程无限占用资源。通过设置一个周期，程序运行超过周期就中断。</li>
</ul>
<h3 id="main-parts">Main parts</h3>
<h4 id="process-management">Process Management</h4>
<ul>
<li>进程是activity entity；程序是passive entity；进程是执行的程序。进程结束需要回收reclaim任何可用资源。</li>
<li>单线程进程：有一个程序计数器记录下一条指令的地址。</li>
<li>多线程进程：每个线程都有一个程序计数器。多个进程通过复用CPU并发执行。</li>
<li>活动：增删用户和进程、挂起Suspend/恢复Resume进程、提供同步synchronization和通信communication的机制、提供死锁deadlock处理机制。</li>
</ul>
<h4 id="memory-management">Memory Management</h4>
<ul>
<li>数据和指令在使用之前必须在内存之中。</li>
<li>活动：跟踪当前使用部分、数据移入移出内存、申请分配空间。</li>
</ul>
<h4 id="storage-management">Storage Management</h4>
<ul>
<li>逻辑上统一表示 file，文件通常被组织到目录中；</li>
<li>文件系统的管理：</li>
<li>访问控制/权限：确认谁可以访问什么；</li>
<li>活动：增删操作文件和目录、文件映射到磁盘/辅存、文件备份到稳定存储介质中；</li>
<li>海量存储管理：</li>
<li>磁盘管理主存放不下的内容，速度取决于磁盘子系统和他的算法；</li>
<li>
<p>活动：空闲空间、存储分配、磁盘调度；</p>
</li>
<li>
<p>IO子系统：</p>
</li>
<li>缓存buffering</li>
<li>快缓存caching</li>
<li>假脱机spooling</li>
<li>统一接口</li>
<li>驱动程序</li>
<li>OS Purposes</li>
<li>抽象、复用、隔离、共享、安全、性能、跨平台使用</li>
</ul>
<h2 id="os-structuresok">OS Structures:ok:</h2>
<h3 id="os-services">OS Services</h3>
<p>User</p>
<ul>
<li>用户接口：界面、命令行CLI、交互式、脱机式批处理.bat文件</li>
<li>程序执行、错误检测、进程交流</li>
<li>IO操作</li>
<li>文件系统控制</li>
</ul>
<p>System </p>
<ul>
<li>资源分配</li>
<li>记录Logging/Accounting</li>
<li>保护</li>
</ul>
<h3 id="system-call">System call</h3>
<ul>
<li>API 比系统调用高级，API是更高级的封装, JVM，</li>
<li>
<p>实现</p>
</li>
<li>
<p>系统调用表</p>
</li>
<li>参数 三种传递方式：:imp: <ol>
<li><strong>参数放到寄存器中</strong>；</li>
<li>Parameters stored in a block, or table, in memory,and address of block passed as a parameter in a reg；<strong>参数放到 内存</strong>/<strong>然后把内存其实地址放寄存器</strong>，用户模式和kernel模式的内存是共享但是有隔离，实际要考虑虚拟地址转换；</li>
<li><strong>栈</strong>；Parameters placed, or pushed onto the <strong>stack</strong> by the program and popped off the stack by the OS</li>
</ol>
</li>
<li>
<p>系统调用分类</p>
</li>
<li>
<p>进程控制 </p>
</li>
<li>
<p>文件管理</p>
</li>
<li>
<p>设备管理：控制 io</p>
</li>
<li>
<p>信息维护</p>
</li>
<li>
<p>交流</p>
</li>
<li>
<p>保护</p>
</li>
</ul>
<h3 id="_2">系统程序</h3>
<p>大多数的系统程序为系统调用提供接口，其他的可能更复杂；</p>
<ul>
<li>文件管理：文件修改等</li>
<li>状态信息：时间，磁盘空间，日志等</li>
<li>编程支持：编译器、汇编器、调试器</li>
<li>相互交流：设备驱动</li>
</ul>
<h3 id="os">OS 设计和实现</h3>
<ul>
<li>首先进行目标设定，多方因素影响(硬件，系统类型)，not solvable</li>
<li>策略和机制分离：</li>
<li>2.6.2(V-10) Policy(策略：要做什么事) Mechainism(机制：达到目的的手段)。例如Linux中的配置文件</li>
<li>系统应该定义的是机制，提供工具而不是使用方式。策略交给用户决定。</li>
<li>分离的目的：可以让同样的机制之上定义不同的policy，别写死，不灵活</li>
</ul>
<h3 id="os_1">OS 结构</h3>
<ul>
<li>
<p>Monollrhic 宏内核：包括IO，文件等管理，CPU等，运行在内核态</p>
</li>
<li>
<p>代表：linux</p>
</li>
<li>优点：模块调用交流会更方便，系统调用效率高</li>
<li>
<p>缺点：安全性不好，隔离比较弱，模块耦合高，调试维护难度大
        <img alt="image-20240923103257503" src="../OS.assets/image-20240923103257503.png" /></p>
</li>
<li>
<p>Microkernel 微内核：CPU调度，内存管理，进程交流，不包括文件存储等，运行在内核态</p>
</li>
<li>
<p>缺点：模块调用会有额外开销overheaed(主要是和用户模块打交道时产生的)，系统服务等更复杂，上下文切换不便捷</p>
</li>
<li>
<p>优点：安全性较高更稳定，隔离度高可移植性可扩展性高
        <img alt="image-20240923103234424" src="../OS.assets/image-20240923103234424.png" /></p>
</li>
<li>
<p>Hybrid 混合内核：Darwim(Windows, MacOS)</p>
</li>
<li>
<p><img alt="image-20240923103541355" src="../OS.assets/image-20240923103541355.png" /></p>
</li>
<li>BSD 可以提供 API 接口</li>
<li>Mach 可以在微内核的基础上扩展，本质上还是微内核</li>
<li>
<p>目的：兼容宏内核的高效，微内核的模块化</p>
</li>
<li>
<p><strong>Layered Approach</strong> 分层方法：逻辑分层，</p>
</li>
<li>
<p>上层调用下层的服务，不允许跨层调用，只能一层层来，</p>
</li>
<li>优点：封装好，方便调试和维护</li>
<li>
<p>缺点：调用效率会降低，<strong>跨层通讯额外开销</strong>，且逻辑分层不明确</p>
</li>
<li>
<p><strong>Modules</strong> 模块化：</p>
</li>
<li>
<p>Loaded Kernel Module 可加载内核模块 .ko</p>
</li>
<li>
<p>优点：可扩展能力，简化实现和设计，方便维护 </p>
</li>
<li>
<p>其他结构：</p>
</li>
<li>
<p><strong>Exokernel</strong> 外核：极致微内核，只提供低级硬件操作；</p>
<ul>
<li>
<p>很高的定制化，其他的资源管理通过用户态library实现；</p>
</li>
<li>
<p>性能很高，但是library定制开发实现难度大，兼容性差很；</p>
</li>
<li>
<p>学术上好，实现上难；</p>
</li>
</ul>
</li>
<li>
<p>Unikernel: 用户程序在启动的时候就启动了，性能很高，有点像是容器</p>
<ul>
<li><img alt="image-20240923105525147" src="../OS.assets/image-20240923105525147.png" /> </li>
</ul>
</li>
</ul>
<h3 id="virtual-machine">Virtual Machine</h3>
<ul>
<li>逻辑上极致的分层，把物理资源也做了分层，虚拟映射；</li>
<li>在虚拟化平台上面构建不同的操作系统，叫全虚拟化 Type2 Hosted Architectured<em>好处：更方便使用，好切换，和当前OS兼容</em></li>
<li>在物理的硬件上面直接运行不同的系统，硬件辅助Type1 Bare-Metal Architectured <em>好处：更高性能、和硬件直接接触、安全性更高没有HostOS干预</em></li>
<li>还有嵌入式的虚拟机，底层应用，例如Type0 需要特殊硬件支持 Intel amd</li>
<li>Java虚拟机JVM，一次编译，多次执行，多线程支持，类库</li>
</ul>
<p>不同技术的对比：</p>
<ul>
<li>VM：具有隔离性，但又资源消耗问题，启动时间更长</li>
<li>Linux Container：容器技术，更轻量级，定制化配置</li>
<li>Unikernel：生态比较小，兼容性更差</li>
</ul>
<h3 id="os-startup">OS Startup</h3>
<p>阅读</p>
<ul>
<li><strong>Bootstrap program (a.k.a.bootstrap loader)</strong>,code stored in ROM,  locates the kernel, load it into memeory</li>
<li>有时需要两个过程  首先 <strong>boot block</strong> at fixedlocation loads bootstrap loader，其次 <strong>bootstrap</strong> loads kernel</li>
</ul>
<h2 id="processesok">Processes:ok:</h2>
<h3 id="process-concept">Process Concept</h3>
<ul>
<li>概念：进行当中的程序，例如</li>
<li>批处理Batch <strong>Jobs</strong>(单道批处理、多道批处理)</li>
<li>
<p>分时系统Time-Sharing/Multi-tasking  <strong>Processes</strong>/<strong>Tasks</strong> </p>
</li>
<li>
<p><strong>包含</strong>：文本(代码)、数据(全局变量)、<strong>栈(函数参数，返回地址，局部变量，静态变量)、堆(动态变量的申请和释放)</strong>、程序计数器(PC)
    这里堆和栈只是一个地方，不是数据结构</p>
</li>
<li>
<p><strong>状态</strong>：new、 running正在用CPU、 ready(已经 loaded 内存)、 waiting/blocked有IO等事件、 terminated结束</p>
<p><img alt="image-20240923113928091" src="../OS.assets/image-20240923113928091.png" /> </p>
</li>
<li>
<p>PCB：每个进程记录在PCB中 Process Control Block(进程状态等信息)</p>
<ul>
<li>包含：状态、PC、CPU寄存器的内容、CPU调度信息、内存管理信息、计数统计信息</li>
<li><img alt="image-20240925150449633" src="../OS.assets/image-20240925150449633.png" /></li>
<li>从图上可以看出，PCB的换入和换出造成了额外的开销，这是必要的；</li>
<li>其他补充：延迟中断的手段、进程状态的切换、原子性操作；</li>
</ul>
</li>
</ul>
<h3 id="process-scheduling">Process Scheduling</h3>
<ul>
<li>数据结构：链表实现 queue(Job Ready Device(s)) -- 进程漫游(migrate)在不同的队列</li>
<li>job queue: all set of processes，所有的进程</li>
<li>ready queue: ready/waiting to execute, in main memory，准备好要执行</li>
<li>
<p>device queues: waiting IO devices，被阻塞了</p>
</li>
<li>
<p>Schedulers：一段程序</p>
</li>
<li>长期调度、决定了degree of multiprogramming（Unix和Windows不采用长期调度）</li>
<li>短期调度、非常频繁 frequently</li>
<li>补充：medium 换入换出 </li>
<li>进程的特性：I/O-bound process 和IO强相关、 CPU-bound process 和CPU强相关</li>
<li>上下文切换：放在PCB中的信息，两个不同的<strong>运行中的</strong>进程</li>
</ul>
<h3 id="process-operation">Process Operation</h3>
<p><img alt="image-20241009142423184" src="../OS.assets/image-20241009142423184.png" /></p>
<ul>
<li>进程创建：父进程创建子进程、....资源共享（全部、部分、不共享）、并发执行，父进程等待子进程结束</li>
<li>
<p>fork 子进程 -&gt; 进程树</p>
<ul>
<li>资源共享：父进程和子进程(共享全部、部分、不共享)</li>
<li>执行形式：父进程和子进程(允许并发，必须等待)</li>
<li>Address space 复制父进程的地址空间，新的pid</li>
<li>system call 替换内存空间</li>
<li>Termination</li>
</ul>
</li>
<li>
<p>exec</p>
<ul>
<li>替换当前进程</li>
</ul>
</li>
<li>
<p>进程终止</p>
</li>
<li>exit：执行结束的时候</li>
<li>abort：parent终止子进程执行<ul>
<li>parent进程结束后，一些OS不允许子进程继续cascading termination</li>
<li>parent进程结束后，一些OS允许子进程变成孤儿进程</li>
</ul>
</li>
</ul>
<h3 id="cooperating-processes">Cooperating Processes</h3>
<ul>
<li><strong>独立进程</strong>不会影响相互的执行，<strong>协作进程</strong>可以互相影响执行</li>
<li>好处：信息共享、计算迅速、模块化、方便</li>
<li>Producer-Consumer</li>
<li>主要问题：数据和信息的同步</li>
</ul>
<h3 id="communicatonipc">Communicaton(IPC)</h3>
<p>IPC : Inter Process Communication 进程间通信</p>
<p>最小化共享资源，处理错误，同步机制</p>
<ul>
<li>
<p><strong>共享内存</strong>，同步状态，速度快，互斥控制，缺点：需要数据拷贝，额外开销，容易产生冲突</p>
</li>
<li>
<p><strong>消息队列</strong>，消息传递，缺点：速度慢</p>
</li>
<li>
<p>Direct Commucation: PQ两个实体之间只能有一个Link，通常是双向的</p>
</li>
<li>
<p>Indirect Commucaiton: mailboxes/ports，每个pair之间可以有多个Link，可以是双向或单向</p>
<ul>
<li>问题：一写多读？Solution</li>
</ul>
</li>
<li>Synchronous: 阻塞， send和receive都要等待直到完成通信</li>
<li>
<p>Asynchronous: 异步(多线程)，不阻塞，不等待，提高整体效率</p>
<p><img alt="image-20240930111627474" src="../OS.assets/image-20240930111627474.png" /></p>
</li>
<li>
<p>管道/套接字...commucation link? shared-mem or sys_bus? logical?</p>
</li>
<li>
<p>Buffering: </p>
</li>
</ul>
<h2 id="threadsok">Threads:ok:</h2>
<h3 id="overview_1">Overview</h3>
<ul>
<li>
<p>responsive 最求更高响应</p>
</li>
<li>
<p>small pieces 交互性更高</p>
</li>
<li>
<p>peek/check 效率不高</p>
</li>
<li>
<p>thread 进程内部多线程，交互性高且效率高</p>
<p><img alt="image-20241009150606849" src="../OS.assets/image-20241009150606849.png" /></p>
</li>
<li>
<p>线程是CPU调度执行的最小单位(TCB用来调度)</p>
</li>
<li>
<p>线程三个状态：就绪、运行、等待</p>
</li>
</ul>
<h3 id="multi-thread">Multi-thread</h3>
<h4 id="_3">线程的好处</h4>
<ul>
<li>响应好、Responsiveness</li>
<li>资源共享、memory for code and data can be shared</li>
<li>资源节约、creating processes are more expensive</li>
<li>提高并发/实现并行、Utilization of MP Architectures利用多核架构</li>
</ul>
<h4 id="user-threads">User Threads</h4>
<ul>
<li>用户线程库：user-level threads library ULT</li>
<li>内核无感，只是用户的代码逻辑</li>
<li>好处：不需要状态的转换(只是进程内部的切换，有现成库管理)</li>
<li>缺点：某一个线程系统调用后可能会阻塞其他的线程，能够创建的线程有限的</li>
</ul>
<h4 id="kernel-threads">Kernel Threads</h4>
<ul>
<li>kernel threads KLT 执行的载体</li>
<li>好处：内核可以直接调度，高效切换</li>
<li>缺点：状态的转换，额外开销</li>
</ul>
<h4 id="_4">映射模型</h4>
<ul>
<li>多对一：更高效，user thread &lt;-&gt; kernel thread 例如JVM，多个用户拒线程映射到一个内核级线程</li>
<li>一对一：并发好，额外开销；主流OS支持 例如Linux /Windows XP/ Solar</li>
<li>多对多：更灵活LWP ID 例如 Solar</li>
<li>Two-level Model: 两种级别叠加：同时存在一对一、多对多</li>
</ul>
<h3 id="threading-issues">Threading Issues</h3>
<h4 id="_5">语义的变化</h4>
<ul>
<li>fork() 线程应该复制这个进程的所有线程，还是只复制调用fork的线程？吸血系统有两个版本的fork</li>
<li>复制一个：省内存空间、线程同步问题？</li>
<li>复制全部：数据一致性保证</li>
<li>exec() 替换进程的映像，整个进程都会被替换</li>
</ul>
<h4 id="_6">线程取消</h4>
<ul>
<li>进程 termination</li>
<li>线程 Thread cancellation</li>
<li>异步：立即取消线程 可能会资源泄露</li>
<li>延后：间断性检查flag判断要不要取消 但是会有额外开销</li>
</ul>
<h4 id="_7">信号处理</h4>
<ul>
<li>信号处理函数、回调函数</li>
</ul>
<h4 id="_8">线程池</h4>
<ul>
<li>预先创建、等待被分配、可以被复用</li>
<li>优点</li>
<li>响应速度会更高</li>
<li>资源利用率高</li>
</ul>
<h4 id="_9">特定数据</h4>
<ul>
<li>TLS 线程池维护</li>
</ul>
<h4 id="_10">调度激活</h4>
<ul>
<li>上调用 upcalls</li>
</ul>
<h2 id="cpu-schedulingok">CPU Scheduling:ok:</h2>
<p>从ready queue 到 running queue
<img src="OS.assets/image-20250101141658478.png" alt="image-20250101141658478" style="zoom:50%;" /> 调度的资源是CPU、调度的对象是进程/线程</p>
<h3 id="basic-concepts">Basic Concepts</h3>
<ul>
<li>Goal: Maximum <strong>CPU utilization</strong> obtained with <strong>multiprogramming</strong> </li>
<li>CPU burst:CPU执行时间; IO burst: IO执行时间;</li>
<li>CPU bound: CPU-密集型进程; IO bound: IO-密集型进程;</li>
<li>什么时候进行CPU调度(下面四个都是非抢占式)：</li>
<li>从running state 到 waiting state</li>
<li>从 running state 到 ready state</li>
<li>从 waiting state 到 ready state</li>
<li>进程终止的时候</li>
<li>抢占 or 非抢占 preemptive?</li>
<li>分配程序：Dispatcher，把CPU的分配权交给短期调度程序</li>
<li>切换上下文</li>
<li>切换到用户模式（非必须）</li>
<li>跳转到合适的位置</li>
<li>Dispatch latency ：分配延迟</li>
</ul>
<h3 id="scheduling-criteria">Scheduling Criteria</h3>
<ul>
<li>CPU利用率</li>
<li>吞吐率：单位时间中执行完成的进程数量</li>
<li>周转时间 turnaround time：执行特定进程的时间</li>
<li>等待时间 waiting time (在ready queue里面的时间，不是waiting state里的时间)</li>
<li>响应时间 response time (从提交到第一次响应的时间)</li>
</ul>
<h3 id="scheduling-algorithms">Scheduling Algorithms</h3>
<h4 id="fcfs">FCFS</h4>
<ul>
<li>算法：先来先服务</li>
<li>优点：公平、简单</li>
<li>缺点：</li>
<li>护航效应Concoy effect：所有进程都在等待一个大进程</li>
<li>可能导致IO与CPU的空闲</li>
<li>对长进程有利，对CPU-bound进程有利</li>
</ul>
<h4 id="sjf">SJF</h4>
<ul>
<li>算法：shortest-Job-First 两种可以抢占/非抢占</li>
<li>非抢占：等当前运行完</li>
<li>抢占：也叫做SRTF Shortest-Remaining-Time-First</li>
<li>问题？怎么知道进程的cpu-burst/剩余时间呢？指数平均法</li>
</ul>
<p>$$
t_{n+1} = \alpha t_n + (1 - \alpha)t_{n-1} + ... + (1+\alpha)^jt_{n-j} + ... + (1-\alpha)^{n}t_0
$$</p>
<ul>
<li>SJF是平均等待时间最优的</li>
<li>可能会导致饥饿 starvation</li>
<li>对短作业有利</li>
</ul>
<h4 id="priority-scheduling">Priority Scheduling</h4>
<ul>
<li>
<p>算法：优先级调度，抢占/非抢占</p>
</li>
<li>
<p>问题：静态优先级调度会带来<strong>饥饿</strong>的问题，可能会导致进程永远无法执行</p>
</li>
<li>解决方法：Aging老化、动态优先级，随着时间进程的优先级提高</li>
</ul>
<p><strong>特殊的优先级调度</strong>：高响应比HRRN (非抢占的，因为需要计算等待时间和执行时间)
$$
P = \frac{T_{wait}+T_{CPU}}{T_{CPU}}
$$</p>
<ul>
<li>缺点：要计算时间</li>
<li>优点：减少饥饿，提高交互性</li>
</ul>
<h4 id="round-robin-rr">Round Robin (RR)</h4>
<ul>
<li>轮转调度 Quantum时间量 (抢占)</li>
<li>比SJF等待时间更高，比SJF响应会更好</li>
<li>应用：分时系统/MultiTasking</li>
<li>q的大小：大FCFS，小overhead高；</li>
</ul>
<h4 id="_11">多级队列</h4>
<p>把ready就绪队列划分成几个不同的队列，例如：foreground process、background process</p>
<p>不同队列之间调度方式</p>
<ol>
<li>优先级调度，例如：先用前台调度再用后台调度，可能导致饥饿</li>
<li>时间片划分调度，例如：80%前台RR调度、20%后台FCFS调度</li>
</ol>
<h4 id="_12">多级反馈队列</h4>
<p>进程可以在多个队列之间移动，Aging可以通过这种方法实现。</p>
<p>需要的参数有：队列的个数、每个队列的调度方式、判断进程升级/降级、判断使用的队列</p>
<ul>
<li>设置多个就绪队列，优先级递减</li>
<li>优先级高的队列，进程时间片越短</li>
<li>每个队列都采用 FCFS ，若在该时间片完成，则撒离系统，未完成，转入下一级级队列</li>
<li>按队列优先级调度，仅当上一级为空时，才运行下一级想·</li>
</ul>
<h4 id="_13">多处理器调度</h4>
<ul>
<li>假设同构</li>
<li>非对称：一个CPU调度，剩下的执行，可靠性不高</li>
<li>对称：SMP </li>
</ul>
<h3 id="real-time-schedule">Real-Time Schedule</h3>
<ul>
<li>软实时/硬实时(一定在ddl前运行完，要求更高)</li>
<li>调度方式</li>
<li>最早截止时间优先</li>
<li>最低松弛度优先</li>
<li>速率单调调度</li>
</ul>
<h3 id="thread-shceduling">Thread Shceduling</h3>
<ul>
<li>本地调度：线程库，基于优先级LWP</li>
<li>全局调度：多对一(等于进程调度)、一对一</li>
</ul>
<blockquote>
<p>常见操作系统的CPU调度策略：</p>
<ol>
<li><strong>Solaris</strong>：优先级0-59</li>
<li><strong>Linux</strong>:分时/软实时、Win-XP如下：</li>
<li><strong>Windows XP</strong>： interrupt masks、 spinlocks (busy-waiting semaphore)、dispatcher objects</li>
<li><img alt="image-20250101193612503" src="../OS.assets/image-20250101193612503.png" /> </li>
<li><strong>Pthreads</strong>：mutex locks、condition variables、 extensions（read-write locks、spin locks）</li>
</ol>
</blockquote>
<h2 id="process-synchronizationok">Process Synchronization:ok:</h2>
<h3 id="basic">Basic</h3>
<ul>
<li>进程同步：解决<strong>协作进程</strong>在<strong>并发访问</strong>同一个数据时候的<strong>不一致</strong>性问题，需要一些<strong>机制</strong></li>
<li>临界区问题：<strong>临界资源</strong> <strong>临界区</strong> ，协作进程可能会互相应影响、例如生产者消费者问题</li>
<li>
<p>竞态条件：共享变量数据不一致问题（例如，counter）</p>
<ul>
<li>defination：a situation in which a memory location is accessed <strong>concurrently</strong>, and at least one access is a <strong>write</strong>.</li>
<li>注意：critical section problems in OS kernel</li>
</ul>
</li>
<li>
<p><strong>Solution to Critical-Section Problem</strong></p>
<ul>
<li>互斥、空闲让进、有限等待、(让权等待)</li>
</ul>
</li>
<li>
<p>同步机制：软件、硬件、信号量、管程</p>
</li>
</ul>
<h3 id="_14">软件机制</h3>
<p>前面四个都是针对两个进程之间的同步，最后的面包房算法是针对多个进程之间的同步</p>
<h4 id="_15">单标志法</h4>
<ul>
<li>turn=i 允许Pi进入；结束后turn=j交给Pj；</li>
<li>必须轮替进入，不满足空闲让进；</li>
<li>互斥 ~~空闲让进~~ 有限等待 </li>
</ul>
<h4 id="_16">双标志后检查法</h4>
<ul>
<li>
<p>flag[2]：flag[i]=true表示进程Pi想进入；结束后flag[i]=false允许对方进入；</p>
</li>
<li>
<p>进去之前前表达自己意愿，在询问对方想不想进入；</p>
</li>
</ul>
<pre><code class="language-cpp">    flag[i]=true;           // 先设置
    while( flag[j] ); // 后检查
         critical section
    flag[i]=false; 
         remainder section
</code></pre>
<ul>
<li>
<p>可能导致双方都不能进入，违反空闲让进</p>
</li>
<li>
<p>互斥 ~~空闲让进~~  有限等待</p>
</li>
</ul>
<h4 id="_17">双标志先检查法</h4>
<ul>
<li>flag[2]：flag[i]=true表示进程Pi想进入；结束后flag[i]=false允许对方进入；</li>
<li>进去之前先询问对方想不想进入，然后在表达自己的意愿；</li>
</ul>
<pre><code class="language-c">while( flag[j] ); // 先检查
flag[i]=true;           // 在设置
     critical section
flag[i]=false; 
     remainder section
</code></pre>
<ul>
<li>违反互斥，不用交替进入</li>
<li>~~互斥~~ </li>
</ul>
<h4 id="petersons-solutionimp">Peterson's Solution:imp:</h4>
<ul>
<li>使用 <strong>trun + flag[2]</strong>，结合<strong>单标志法</strong>和<strong>双标志后检查法</strong>，首先表达自身意愿(flag[]=true) 之后设置自身要进入 (turn=0/1) ；turn 只能等于一个值，因此会谦让对方进入；若一方不想进入，则其 flag[i]=false ，对方可直接进入；</li>
</ul>
<pre><code class="language-c">flag[i] = true;
turn = j;
while ( flag[j] &amp;&amp; turn == j);
  // CRITICAL SECTION
flag[i] = false;
  // REMAINDER SECTION
</code></pre>
<ul>
<li>互斥 空闲让进  有限等待 <strong>都满足</strong></li>
<li>问题：现在的编译器核能会调整顺序；</li>
<li>解决方法：使用内存栅栏；memory barrier</li>
</ul>
<p>```js(3)
flag[i] = true;
turn = j;
asm(“mfence”);
while ( flag[j] &amp;&amp; turn == j);</p>
<pre><code>
#### Bakery Algorithm

- 思路：排队叫号
    - boolean choosing[n]: 表示进程是否在取号；初始 false 。
    - int number[n]: 记录每个进程取到的号码；初始 0 
    - （ a ， b ）＜（ c ， d ） : (1) a ＜ c, or (2) a==c 且 b ＜ d

- 互斥 空闲让进  有限等待 

### 硬件机制

&gt; **注意：下面的代码是硬件实现的，表示执行的逻辑，如果说是自己手动实现的这些代码是不能够完成同步的。**

#### 关中断法

- 进入临界区前直接屏蔽中断，保证临界区资源顺利使用；使用完毕，打开中断；
- Uniprocessors，可以disable interrupts
    - 只适用于但CPU系统，多处理器同步问题
    - 并发性降低，效率低，资源利用率低
    - 安全性低 稳定性低，关闭终端导致一些重要请求错过了

- provide special atomic hardware instructions
    - `Atomic = non-interruptable` 



#### TestAndSet 指令

```cpp
boolean TestAndSet (boolean *target) {
    boolean rv = *target;
    *target = TRUE;
    return rv:
}
</code></pre>
<pre><code class="language-cpp">while (true) {
    while ( TestAndSet (&amp;lock ))
    ; /* do nothing*/
        // critical section
    lock = FALSE;
        // remainder section 
}
</code></pre>
<ul>
<li>互斥 空闲让进  ~~有限等待~~</li>
</ul>
<h4 id="swap">Swap 指令</h4>
<pre><code class="language-cpp">void Swap(boolean *a, boolean *b) {
    boolean temp = *a;
    *a = *b;
    *b = temp;
}
</code></pre>
<pre><code class="language-cpp">while (true) {
   key = TRUE;
   while (key == TRUE)
        Swap(&amp;lock, &amp;key); 
   // critical section
   lock = FALSE;
   // remainder section 
 }
</code></pre>
<ul>
<li>对每个临界资源， swap 设置一个全局 bool 变量 lock、每个进程设置局部变量 key</li>
<li>互斥 空闲让进  ~~有限等待~~</li>
</ul>
<h4 id="cas">CAS 指令</h4>
<p>共享lock变量初始化为0</p>
<pre><code class="language-cpp">int compare_and_swap(int *value, int expected, int new_value) { 
    int temp = *value; 
    if (*value == expected) 
            *value = new_value; 
    return temp; 
}
</code></pre>
<pre><code class="language-c">while(true){
    while (compare_and_swap(&amp;lock, 0, 1) != 0) 
    ; /* do nothing */ 
        /* critical section */ 
    lock = 0; 
        /* remainder section */ 
 }
</code></pre>
<p>满足Bounded-waiting的算法如下所示：</p>
<pre><code class="language-cpp">while (true) {
    waiting[i] = true;
    key = 1;
    while (waiting[i] &amp;&amp; key == 1) 
            key = compare_and_swap(&amp;lock,0,1); 
    waiting[i] = false; 
    /* critical section */ 
    j = (i + 1) % n;  // 遍历所有的进程
    while ((j != i) &amp;&amp; !waiting[j])  // 这个进程不想要进入临界区
            j = (j + 1) % n; 
    if (j == i)  // 遍历完了所有的其他进程都执行完了，就轮到了自己执行
            lock = 0;  // 放开锁
    else // 其他的程序也想要进入，设置为waiting=false他就跳出了while循环开始执行
            waiting[j] = false; 
    /* remainder section */ 
}
</code></pre>
<ul>
<li>Boolean waiting[n]: 排队队列</li>
<li>性质：Executed atomically</li>
<li>互斥 空闲让进  有限等待</li>
</ul>
<h4 id="mutex">Mutex 锁</h4>
<ul>
<li>First <strong>acquire()</strong> a lock </li>
<li>Then <strong>release()</strong> the lock</li>
<li>Calls to <strong>acquire()</strong> and <strong>release()</strong> must be <strong>atomic</strong> 必须是原子性操作</li>
<li>spinlock自旋锁：一种需要持续占用CPU检测的锁，会有下面这种问题</li>
<li>问题：busy waiting，占用CPU，在单核系统中不能实现</li>
</ul>
<blockquote>
<p>硬件实现的优点：</p>
<ol>
<li>适用于任意数目的进程，在单处理器或多处理器上</li>
<li>简单，容易验证其正确性</li>
<li>可以支持进程内存在多个临界区，只需为每个临界区设立一个布尔变量</li>
</ol>
<p>硬件实现的缺点：</p>
<ol>
<li>耗费 CPU 时间，不能实现“让权等待”、可能导致 忙等待 busy waiting，例如：自旋锁</li>
<li>可能不满足有限等待：从等待进程中随机选择一个进入临界区，有的进程可能一直选不上</li>
<li>可能死锁</li>
</ol>
</blockquote>
<h3 id="imp">信号量机制:imp:</h3>
<ul>
<li>满足让权等待、解决 busy waiting </li>
<li>
<p>通过两种原子性的操作：</p>
<ul>
<li>wait() signal() / P() V() </li>
</ul>
</li>
<li>
<p>种类：整形 二进制 其他And等（可以用二进制信号量实现计数信号量）</p>
</li>
</ul>
<p>实现互斥(不能同时访问)，如下：</p>
<pre><code class="language-java">Semaphore S
Wait (S);
Critical Section
Signal (S);
Remainder Section
</code></pre>
<p>实现同步(限制先后顺序)，如下：两个进程满足S1先执行、S2后执行</p>
<pre><code class="language-c">// P1
S1
Signal (S);
// P2
other sentenses
Wait (S);
S2
</code></pre>
<p><strong>信号量的初始化</strong> </p>
<ol>
<li>互斥：初始值为1，二进制信号量</li>
<li>同步：计数型信号量，信号量的个数=需要同步资源类型数、信号量初始值=该类资源个数</li>
</ol>
<p><strong>信号量的实现</strong> </p>
<p>实现信号量要保证：wait()和signal()是原子性操作、临界区问题（就类似前面软件/硬件实现思路）</p>
<ol>
<li>
<p><strong>忙等类型</strong>：wait + signal，进程在等待信号量时，会进行忙等，不释放 CPU。这种方法在多核系统中可能有用（因为一个核忙等时，其他核仍然可以工作），但对于单核系统非常浪费资源。</p>
<ul>
<li>
<p>P 和 V 在不同的CPU上跑</p>
</li>
<li>
<p>生产者V太少，P会一直转</p>
</li>
<li><img src="OS.assets/image-20241231161446915.png" alt="image-20241231161446915" style="zoom: 50%;" /> </li>
</ul>
</li>
<li>
<p><strong>非忙等类型</strong>：wait +signal + 等待queue(操作 sleep wakeup)，进程在等待信号量时，会被加入信号量的等待队列，并进入<strong>睡眠状态</strong>，在这种情况下，进程会让出 CPU，等到条件满足时，由操作系统唤醒它，避免 CPU 时间的浪费。</p>
<ul>
<li>
<p>每个信号量包括两个部分：value + pointer to a linked-list of PCBs</p>
</li>
<li>
<p>问题：额外开销sleep的时候</p>
</li>
<li>
<p>问题：lost wakeup</p>
</li>
<li>
<p>解决：调整锁在while之前 + sleep(s, &amp;s-&gt;lock)释放锁在while中间</p>
</li>
<li><img src="OS.assets/image-20241106140103234.png" alt="image-20241106140103234" style="zoom: 33%;" />  </li>
</ul>
</li>
</ol>
<p>死锁问题：两个或多个进程无限等待</p>
<p>饥饿问题：一个进程可能无法从等待队列中出来</p>
<p><strong>经典问题</strong> 1 生产者消费者问题（有界缓冲区问题）N个缓冲区，保持互斥访问</p>
<p>需要三个信号量来实现：一个互斥初始化=1、一个full初始化为=0、一个empty初始化=N</p>
<blockquote>
<p>注意：两个wait的顺序不能变，否则会逻辑不正确（例如Producter还没生产，Consumer就先mutex，然后发现一直在wait(full)，但是Product因却一直在wait(mutex)，造成死锁</p>
<p>singal的顺序可以变的，不会影响逻辑正确性</p>
</blockquote>
<pre><code class="language-c">// Product
while(true){
  wait(empty);
  wait(mutex);
  //add to buffer
  signal(mutex);
  signal(full);
}
</code></pre>
<pre><code class="language-c">// Consumer
whiel(true) {
  wait(full);
  wait(mutex);
  //remove from buffer
  signal(mutex);
  signal(empty);
}
</code></pre>
<p><strong>经典问题</strong> 2 读者写者问题（并发进程的共享）读者只能读、写者可以读也可以写、允许多个读者、只允许一个写者、读者有限</p>
<p>需要一个整型变量：记录读者数量初始化=0（因为这里有多个用户的共享）</p>
<p>需要两个信号量实现：一个互斥访问读者数量初始化=1、一个互斥写初始化为1</p>
<pre><code class="language-c">// Writer
while(true) {
  wait(wrt);
  // writing
  signal(wrt);
}
</code></pre>
<pre><code class="language-cpp">// Reader
while(true) {
  wait(mutex);
  readcount++;
  if(readcount==1) wait(wrt); /*因为wrt初始化=1,读和写要互斥,所以第一个读者来时wait(wrt)*/
  sinal(mutex);
  // reading
  wait(mutex);
  readcount--;
  if(readcount==0) signal(wrt); /*没有读者就是放这个信号量*/
  signal(mutex);
}
</code></pre>
<p><strong>经典问题</strong> 3 DH哲学家就餐问题（共享一碗米饭、五根筷子）</p>
<p>解决方法很多：</p>
<ol>
<li>只允许 4 个同时吃饭；</li>
<li>其中一位反序拿筷子；</li>
<li>AND 信号量；</li>
<li>奇数 ID 和偶数 ID 设置相反拿筷子顺序</li>
</ol>
<h3 id="_18">管程机制</h3>
<p><img alt="image-20241105114848051" src="../OS.assets/image-20241105114848051.png" />管程Monitors是一种高级的抽象，进程<strong>同步</strong>的有效mechanism；同一时间只允许一个进程在Monitor中active；</p>
<ul>
<li>condition variables条件变量：x.wait() x.signal() 里面没有变量，只有condition x；</li>
</ul>
<blockquote>
<p>常见操作系统采用的同步方法：</p>
<ol>
<li><strong>Solaris</strong>：adaptive mutexes、condition variables and readers-writers locks、turnstiles</li>
<li><strong>Windows XP</strong>： interrupt masks、 spinlocks (busy-waiting semaphore)、dispatcher objects</li>
<li><strong>Linux</strong>：disables interrupts（short critical sections） 、semaphores、spin locks</li>
<li><strong>Pthreads</strong>：mutex locks、condition variables、 extensions（read-write locks、spin locks）</li>
</ol>
</blockquote>
<h2 id="deadlocksok">Deadlocks:ok:</h2>
<h3 id="deadlock-characterization">Deadlock Characterization</h3>
<ul>
<li>
<p>如果同时满足下面四个条件就会产生死锁：</p>
</li>
<li>
<p>互斥Mutex</p>
</li>
<li>
<p>请求保持Hold and Wait</p>
</li>
<li>
<p>不剥夺No preemption</p>
</li>
<li>
<p>循环等待Circular wait</p>
</li>
<li>
<p>系统模型：资源类型R、每个资源个数W、每个进程P；进程可以申请/使用/释放资源；</p>
</li>
<li>
<p>资源分配图：V表示资源或者进程；E表示P申请(P-&gt;R)或占有(R-&gt;P)资源；</p>
</li>
<li>
<p>图没有环：没有死锁</p>
</li>
<li>
<p>图有环：如果每类资源只有一个实例-&gt;有死锁；如果每个资源有多个实例-&gt;具体分析；</p>
</li>
<li>
<p>解决方式：</p>
</li>
<li>
<p>Prevention、Avoidance</p>
</li>
<li>Detection、Recovery</li>
<li>Ignore (used by most OS)</li>
</ul>
<h3 id="deadlock-prevention">Deadlock Prevention</h3>
<ul>
<li>破坏四个必要条件之一来防止死锁发生</li>
<li>~~Mutex~~：共享资源可以破坏互斥条件，通过允许多进程同时访问预防死锁；非共享资源无法破坏互斥条件，不能用这个方法预防</li>
<li>~~Hold and  Wait~~：保证进程请求资源时候不持有任何其他资源（资源利用率低、可能饥饿）</li>
<li>~~No preemption~~：进程持有的资源可能因为其他进程的请求而释放、被抢占的资源加到了进程等待的资源列表、进程仅在当他可以重新获得旧资源的时候重启</li>
<li>~~Circular wait~~：确定所有资源的整体顺序，申请按照编号的顺序来；total oedering;</li>
</ul>
<h3 id="deadlock-avoidance">Deadlock Avoidance</h3>
<ul>
<li>
<p>需要多一些先验信息：priori information</p>
</li>
<li>
<p>每个进程 declares 他需要的资源的一个最大的数量；</p>
</li>
<li>Dynamically 检测 the resource-allocation state 确保 never 进入循环等待；</li>
<li>
<p>state通过三个数字来确定：available、allocated、maximum demands；</p>
</li>
<li>
<p>Safe state：当一个进程申请 available 的资源的时候，系统必须判断是否这个申请会使系统离开安全状态；</p>
</li>
<li>
<p>如果存在一个进程序列，可以保证：进程需要的资源 &gt;=  前面所有进程占有的资源+系统剩余资源</p>
</li>
<li>这样入股某个进程当前需要的资源不是立即有空的，就可以等前面进程释放资源之后利用；若干个人</li>
<li>安全状态和死锁的关系？</li>
<li>
<p><img alt="image-20241113204153082" src="../OS.assets/image-20241113204153082.png" /></p>
</li>
<li>
<p>避免的算法-单实例：使用资源分配图</p>
</li>
<li>
<p>进程必须先声明资源先加上边：Claim edge，虚线</p>
</li>
<li>当进程申请资源的时候：Claim edge-&gt;Request edge</li>
<li>当资源被分配给进程时：Request edge-&gt;Assignment edge</li>
<li>当资源被进程释放之后：Assignment edge-&gt;Claim edge</li>
<li>
<p>环检测：包含Claim edge</p>
</li>
<li>
<p>避免的算法-多实例：使用银行家算法Dijistra</p>
</li>
<li>
<p>假设：多个实例、先声明最大使用量、申请资源必须等待、进程得到全部资源后必须有限时间返回</p>
</li>
<li>
<p><code>c
    ResourceRequestAlgorithm () {
      /* Step 1: check request is valid? */
      if(Request[i] &lt;= Need[i]) goto step2;
      else throw error;
      /* Step 2: check resource is enough? */
      if(Request[i] &lt;= Available[i]) goto step3;
      else wait;
      /* Step 3: test to allocate, and check safes state */
      Pretend to request:
        call SafetyAlgorithm;
    }</code></p>
</li>
<li>
<p>n个进程、m个类型；Available/Max/Allocation/Need；Need = Max - Allocation;</p>
</li>
<li>
<p>```java
    SaftyAlgorithm () {
      Work[m];
      /<em> Step 1: initial work = avaible </em>/
      Work = Available;
      for (j=0-&gt;n) Finish[j] = false;
      /<em> Step 2: try to satisfiy one's need </em>/
      Find i : Finish[i]==false &amp;&amp; Need[i][] &lt;= Work[];
      if(No such i) goto step4;
      /<em> Step 3: update available reources </em>/
      Work[] += Allocationi[i][];
      Finish[i] = true;
      goto step2;
      /<em> Step 4: all needs satisfied </em>/
      if all Finish = true
        System is in a safe state;
    }   </p>
<p>```</p>
</li>
</ul>
<h3 id="deadlock-detection">Deadlock Detection</h3>
<ul>
<li>
<p>允许系统进入死锁状态</p>
</li>
<li>
<p>单实例：维持<strong>等待图</strong>（pi-&gt;pj表示pi在等待pj）</p>
</li>
<li>
<p>间断性的调用算法，来检测等待图中有没有环</p>
</li>
<li>检测环的算法需要n^2^ (n是图中顶点个数)的操作</li>
<li>
<p><img src="OS.assets/image-20241230151922920.png" alt="image-20241230151922920" style="zoom:33%;" />  </p>
</li>
<li>
<p>多实例：</p>
</li>
<li>
<p>Available [m] 表示空闲的个数</p>
</li>
<li>
<p>Allocation [n] [m] 表示已经占有的个数</p>
</li>
<li>
<p>Request [n] [m] 表示申请的个数</p>
</li>
<li>
<p>下面的算法和安全算法很像：把Need换成了Request</p>
</li>
<li>
<p><code>c
      DetectinAlgorithm () {
        /* Step 1: initial work = acaible */
        Work = Avaible;
        for(i=1-&gt;n) {
          if(Allocation[i] != 0) Finish[i] = false;
          else Finish[i] = true;
        }
        /* Step 2: try to satisfy one's need */
        Find i: Finish[i] = false &amp;&amp; Request[i][] &lt;= Work[];
        if(no such i) goto step4;
        /* Step 3: update the  */
        Work = Work + Allocation[i];
        Finish[i] = true;
        goto step2;
        /* Step 4 */
        if(exists i such that finish[i]==false)
          System is in deadlock state &amp;&amp; P[i] is deadlocked     
      }</code></p>
</li>
<li>
<p>检测算法需要O(mn^2^) 的操作</p>
</li>
</ul>
<h3 id="recovery-from-deadlock">Recovery from Deadlock</h3>
<ul>
<li>Process Termination：撤销部分甚至全部死锁进程，释放资源</li>
<li>Abort all deadlock processes;</li>
<li>Abort 一个进程直到死锁环消除了；</li>
<li>按照什么顺序Abort？<ul>
<li>进程优先级</li>
<li>结束时间、执行时间</li>
<li>使用这个进程的资源格式</li>
</ul>
</li>
<li>Process Preemption：把部分进程挂起，剥夺其资源</li>
<li>选择一个victim，让他立即释放资源</li>
<li>Rollback 回到安全的状态</li>
<li>Startvation，一些进程可能一直被选为 victim 还有回滚的次数</li>
<li>进程回退法：让一个进程或多个进程回退到避免死锁的地步，释放中间资源</li>
</ul>
<h2 id="main-memoryok">Main Memory:ok:</h2>
<h3 id="background">Background</h3>
<ul>
<li>
<p>内存发展</p>
</li>
<li>
<p>Drum memory 磁鼓存储器</p>
</li>
<li>
<p>Delay Line Memory 延迟线存储器</p>
</li>
<li>
<p>Core Memory 磁芯存储器</p>
</li>
<li>
<p>Semiconductor ROM/RAM 半导体：DRAM, SRAM, ROM(boottrap), EPROM</p>
</li>
<li>
<p>内存墙</p>
</li>
<li>
<p>内存比处理器慢太多，消耗更多的能源</p>
</li>
<li>
<p>由于多核的发展，这个Gap甚至更大</p>
</li>
<li>
<p>NVMs：非挥发性存储器，非易失性存储器</p>
</li>
<li>
<p>PCM：箱变存储器</p>
</li>
<li>
<p>ReRAM/RRAM：电阻是存储器</p>
</li>
<li>
<p>内存计算：与传统的冯诺依曼的存写分离不同，增加效率</p>
</li>
<li>
<p>背景</p>
</li>
<li>
<p>程序必须：从磁盘加载到内存，放到处理器中运行</p>
<ul>
<li>主存和寄存器是CPU能直接访问的存储介质</li>
<li>寄存器可以在一个时钟周期内访问</li>
<li>主存可能需要多个时钟周期内访问</li>
<li>高速缓存cache在主存和寄存器之间</li>
</ul>
</li>
<li>
<p>内存的保护需要保证正确的操作</p>
</li>
<li>
<p>内存等级：</p>
<ul>
<li><img alt="image-20241124165114840" src="../OS.assets/image-20241124165114840.png" /></li>
</ul>
</li>
</ul>
<h3 id="_19">程序运行过程</h3>
<ul>
<li>编译器、连接器、装载器</li>
<li>编译时间：.c-&gt;.o（compiler）</li>
<li>载入时间：.o-&gt;.exe（linker、loader）</li>
<li>执行时间：（动态连接库）</li>
<li><img src="OS.assets/image-20241229143722109.png" alt="image-20241229143722109" style="zoom:50%;" /> </li>
<li>不同过程的地址</li>
<li>符号地址：在源程序中的地址都是符号</li>
<li>可重定位地址：compiler绑定符号地址到可重定位地址(.o中的)</li>
<li>绝对地址：linker, loader将可冲定位地址绑定到绝对地址</li>
<li>地址空间：</li>
<li>逻辑地址：CPU产生的，也叫虚拟地址 LA/VA</li>
<li>物理地址：内存单元中可以看到的地址 PA</li>
<li>地址绑定：就是地址映射，从一个地址空间映射到另一个</li>
<li>绑定指令和数据到内存中的方式</li>
<li>编译时刻绑定：已知内存位置，产生绝对code，如果变化必须重新编译 LA=PA</li>
<li>装入时刻绑定：产生可重定位code，编译时刻内存位置未知 LA=PA</li>
<li>执行时刻绑定：需要硬件支持，直到运行时候再绑定 LA!=PA</li>
<li>基址寄存器和限长寄存器</li>
<li>Base+Limit：定义了逻辑地址空间</li>
<li>内存管理单元：MMU，做VA到PA映射的硬件设备，发送到<strong>内存</strong>(PA)的时候把relocation寄存器(base register)加到每个<strong>用户进程产生的地址</strong>(VA)上</li>
<li>动态重定位：relocation，把CPU看到的逻辑地址转换成内存中的物理地址</li>
<li>动态装入：直到被调用的时候再装入，内存空间利用更好，不需要OS的特殊支持</li>
<li>动态链接：直到执行的时候再链接，使用<strong>stub</strong>来定位合适的内存库，把他替换成进程的地址来执行</li>
<li>OS需要检查是否routine进程是在LA地址中的</li>
<li>userful for：省空间、减少执行镜像文件大小、重新连接不需要的新库</li>
<li>也叫做shared libraries，共享库</li>
</ul>
<h3 id="_20">连续内存分配</h3>
<ul>
<li>
<p>主存通常有两个分区：常驻在OS低内存例如中断向量，用户程序在高内存中</p>
<ul>
<li><strong>relocation register</strong> 用来保护用户程序，避免改变操作系统的代码的数据，保存最小的物理地址，需要硬件的支持</li>
<li><strong>limit register</strong> 把一系列逻辑地址的范围，每个逻辑地址必须必Limit寄存器更小</li>
</ul>
</li>
<li>
<p>MMU 内存管理单元，动态映射逻辑地址，从虚拟地址到物理地址的硬件设备</p>
</li>
</ul>
<p><strong>分配方式</strong>：</p>
<ol>
<li>Single Continous Allocation 单一连续分配：不并发，只运行一个</li>
<li>Multiple-partition allocation 多分区分配：内存划分成不同的联系区域，叫做分区，每个分区存放一个进程。</li>
</ol>
<p><strong>多分区分配</strong>：</p>
<ol>
<li>固定分区：<ul>
<li><img src="OS.assets/image-20241224112540182.png" alt="image-20241224112540182" style="zoom:50%;" /> </li>
<li>会形成分区内的<strong>内部碎片</strong> </li>
</ul>
</li>
<li>可变分区、动态分区：动态划分内存，在程序装入内存时把可用内存“切出”一个连续的区域分配给该进程，且分区大小正好适合进程的需要。<ul>
<li>存在Hole，即空闲块，在内存中随机分布，<strong>外部碎片</strong></li>
<li>OS需要保存的信息包括：分配的分区，空闲分区/空洞</li>
<li>动态分配的方法：first-firt(next-fit)、best-fit、worse-fit</li>
<li><strong>first-fit和best-fit比worse-fit</strong>在速度和空间利用上更好</li>
<li>其他方法：基于索引-快速适应、伙伴系统、哈希算法</li>
</ul>
</li>
</ol>
<p><strong>碎片 fragmentation</strong>：</p>
<ul>
<li>外部碎片：满足需求全部内存碎片、不连续</li>
<li>内部碎片：分配的内存比需要的内存更大，没有用到的大小就是</li>
<li>通过 compaction或者defragmentation可以减少<strong>外部碎片</strong></li>
</ul>
<h3 id="pagingimp">分页 Paging:imp:</h3>
<ul>
<li>
<p>进程的逻辑地址空间可能是非连续的</p>
<ul>
<li>把物理内存分成固定大小的块，叫做帧frome</li>
<li>把逻辑内存分成相同大小的块，叫做页</li>
<li>页表用来做 物理地址 到 逻辑地址的映射</li>
<li>会有内部碎片</li>
</ul>
</li>
<li>
<p>地址转换方式：</p>
<ul>
<li><img alt="image-20241229150929614" src="../OS.assets/image-20241229150929614.png" /> </li>
<li>页号+页内偏移</li>
<li>逻辑地址空间大小 2^m^、页大小2^n^</li>
</ul>
</li>
<li>
<p>硬件，CPU的逻辑地址，页表，物理地址，访问物理内存</p>
</li>
<li>硬件实现页表<ul>
<li>PTBR，页表寄存器，存放页表的地址</li>
<li>PTLR，页表长度寄存器，存放页表长度</li>
</ul>
</li>
<li>两次访问内存问题：第一次先访问页表、第二次访问内存数据（页表存在内存中）<ul>
<li>解决方法：使用fast-lookup hardware cache/associative memory/ TLBS快表</li>
<li>转换时候，先去快表中找，命中就直接访问内存；否则再去页表中找，然后访问内存；</li>
<li><strong>EAT计算</strong>：</li>
<li><img alt="image-20241229152104202" src="../OS.assets/image-20241229152104202.png" /> </li>
</ul>
</li>
<li>内存保护问题：通过页表中Valid-invalid bit<ul>
<li>valid表示相关的也在进程逻辑地址空间中，是合法的；反之类似；</li>
</ul>
</li>
<li>共享页：<ul>
<li>共享代码：只读的代码，对于所有的进程来说这种代码必须有相同的逻辑地址；</li>
<li>私有代码和数据，私有数据可以存在任意的地址空间中；</li>
</ul>
</li>
</ul>
<h3 id="_21">页表结构</h3>
<ul>
<li>分级页表Hierachical Paging<ul>
<li>把逻辑地址空间转换到多级页表（Linux四级、Windows两级）那相当于把原来的页表也分一下页</li>
<li><img alt="image-20241229153502548" src="../OS.assets/image-20241229153502548.png" /> </li>
<li>页表基质寄存器PTBR存放为高级的页表地址</li>
<li>好处：提高性能，程序不需要把所有的页表内容都放到</li>
</ul>
</li>
<li>哈希页表Hashed Page Tables<ul>
<li>在地址空间大于32位的时候用到</li>
<li>每一个页表项都有一个链表</li>
<li>更快，更省空间</li>
</ul>
</li>
<li>倒置页表Inverted Page Tables<ul>
<li>整个系统只有一张页表</li>
<li>但是查找会比较慢</li>
<li><img alt="image-20241229160635231" src="../OS.assets/image-20241229160635231.png" /> </li>
<li>替换Swapping：从内存到Bakcing Store之间的交换 </li>
</ul>
</li>
</ul>
<h3 id="segmentation">分段 Segmentation</h3>
<ul>
<li>内存管理支持按照逻辑单元来划分</li>
<li>例如：程序段、栈、局部变量、全局变量</li>
<li>段表：segment table 两种物理地址之间的映射 base limit</li>
<li>STBR、STLR</li>
<li>保护：valid位、权限控制位</li>
<li>段的硬件：先判断然后转换</li>
</ul>
<h2 id="virtual-memoryok">Virtual Memory:ok:</h2>
<h3 id="background_1">Background</h3>
<ul>
<li>virtual memory system</li>
<li>demand paging、page-repplacement algorithms、allocation pf page frames</li>
<li><strong>working-set model principle</strong></li>
</ul>
<p>Virtual memory</p>
<ul>
<li>逻辑地址空间可能比物理地址空间更大</li>
<li>允许地址空间被多进程共享</li>
</ul>
<p>benefits</p>
<ul>
<li>通过把共享的对象映射到虚拟地址空间可以让多个进程共享系统库、共享内存、共享页</li>
</ul>
<h3 id="demand-pagingimp">Demand Paging:imp:</h3>
<blockquote>
<p>缺页时系统运行的顺序：</p>
<ol>
<li>Operating system looks at another table (kept with PCB) to decide:? Invalid reference, abort? Just not in memory</li>
<li>Get empty frame</li>
<li>Swap page into frame</li>
<li>Reset tables</li>
<li>Set validation bit = <strong>v</strong> </li>
<li>Restart the instruction that caused the page fault</li>
</ol>
</blockquote>
<ul>
<li>需要时把页取到内存中：less IO、less memory、faster response、more users</li>
<li>需要某一页-&gt;reference to it：不合法/abort、不在内存/取到内存中</li>
<li>lazy swapper：懒加载，用一页取一页</li>
<li>eagle swapper：预加载，提前取相邻的几页，局部性原理</li>
<li>valid bit：valid表示在内存中，invalid表示不在内存中，初始化所有都是invalid</li>
<li>
<p>当访问页表进行地址转换时候，如果发现是invalid就发生缺页终端page-fault</p>
<ul>
<li>看其他表判断是不是valid</li>
<li>得到空闲帧，设置内容，重启</li>
</ul>
</li>
<li>
<p>重启的问题Restart instruction：block move</p>
</li>
<li>
<p><strong>EAT计算</strong>：缺页访问的性能</p>
</li>
</ul>
<h4 id="_22">进程创建</h4>
<ul>
<li>
<p>使用虚拟内存在进程创建过程有好处</p>
</li>
<li>
<p><strong>Memory-Mapped Files</strong>：</p>
<ul>
<li>映射到不同进程中，实现对文件的共享</li>
</ul>
</li>
<li>
<p><strong>Copy-on-Write</strong>：</p>
<ul>
<li>
<p>parent进程和child进程可以共享相同的内存页</p>
</li>
<li>
<p>COW允许更高效的进程创建方式-写时复制</p>
</li>
<li>
<p>因为复制操作可能会带来较大的开销</p>
</li>
<li>
<p>写时复制（缺页的时候并不直接就把所有内容进行复制）</p>
</li>
</ul>
</li>
</ul>
<h4 id="page-replacement">Page Replacement</h4>
<blockquote>
<p>替换时系统运行顺序：</p>
<ol>
<li>
<p><strong>Find the location of the desired page on secondary</strong> <strong>storage.</strong> </p>
</li>
<li>
<p><strong>Find a free frame:</strong> </p>
</li>
</ol>
<p><strong>If there is a free frame, use it.</strong></p>
<p><strong>If there is no free frame, use a page-replacement</strong> <strong>algorithm to select a victim frame.</strong> </p>
<p><strong>Write the victim frame to secondary storage (if</strong> <strong>necessary); change the page and frame tables</strong> <strong>accordingly.</strong> </p>
<ol>
<li>
<p><strong>Read the desired page into the newly freed frame;</strong> <strong>change the page and frame tables.</strong> </p>
</li>
<li>
<p><strong>Continue the process from where the page fault</strong> <strong>occurred.</strong> </p>
</li>
</ol>
</blockquote>
<ul>
<li>在内存中替换页面的时候希望：缺页次数更少<ul>
<li>阻止过度分配内存，通过缺页处理例程包含了页置换</li>
<li>使用修改modify/dirty位减少页面的传递（只有写过的在写回磁盘）</li>
<li>页置换是虚拟内存实现的方式，这使得虚拟内存可以比物理内存大很多</li>
</ul>
</li>
<li>reference string， 访问的页面编号的顺序</li>
<li><strong>FIFO</strong>：<ul>
<li>依赖于访问页面顺序，替换掉数组中前面的一个，新的往后面插</li>
<li>问题：存在Belady‘s Anomaly， 内存更大，反而会有更多缺页异常</li>
</ul>
</li>
<li><strong>Optimal</strong>：<ul>
<li>往后看，选择后面最久会用到的替换，最优情况</li>
<li>问题：无法得知后面的访问顺序，用来对比评估其他的性能</li>
</ul>
</li>
<li><strong>LRU</strong>：<ul>
<li>往前看，选择前面最久没有用到的替换</li>
<li>实现<a href="https://note.isshikih.top/cour_note/D3QD_OperatingSystem/Unit3-Part2/#lru">修lao</a>：<ul>
<li>使用一个counter</li>
<li>栈实现用到了就移动带重新压栈/到栈顶,不用遍历</li>
</ul>
</li>
</ul>
</li>
<li><strong>LRU Approximation</strong>：<ul>
<li><strong>Second chance/</strong>时钟算法：<ul>
<li>循环地遍历 frames，并逐一检测 reference bit</li>
<li>如果是0，就选为victim</li>
<li>如果是1，就改写成0</li>
</ul>
</li>
<li><strong>Enhanced Second-Chance Algorithm / NRU</strong><ul>
<li>(0,0)(0,0)：没被用过，也没被修改过；</li>
<li>(0,1)(0,1)：没被用过，但被修改过；</li>
<li>(1,0)(1,0)：被用过，但没被修改过；</li>
<li>(1,1)(1,1)：被用过，也被修改过；</li>
</ul>
</li>
</ul>
</li>
<li>基于技术的置换：LFU、MFU</li>
</ul>
<h4 id="allocation-of-frames">Allocation of Frames</h4>
<ul>
<li>固定分配：平均的分</li>
<li>优先级分配：可以允许有变化的分配方式</li>
<li>全局置换：会有为预测到的缺页异常</li>
<li>局部置换：会有其他进程不能用的空闲的帧</li>
</ul>
<p>注意：固定分配和局部替换一起搭配</p>
<h3 id="thrashing">Thrashing</h3>
<ul>
<li>颠簸/抖动，进程频繁换入换出</li>
<li><strong>解决 Trashing 的关键是避免频繁的页面置换</strong>，即确保有足够的内存供进程使用。为了减少 trashing，通常需要采取以下措施：<strong>增加物理内存</strong> 或 <strong>减少并发进程数</strong>，从根本上减少页面置换。</li>
<li>
<p>其他解决方法：</p>
<ul>
<li>增加物理内存</li>
<li>优化页面置换算法</li>
<li>在 cpu 调度中引入工作集算法</li>
<li>动态调整进程的内存分配</li>
<li>限制并发进程数</li>
<li>内存压缩</li>
</ul>
</li>
<li>
<p><strong>Working-Set Model</strong>:imp: ?</p>
<ul>
<li><img alt="image-20241229175543723" src="../OS.assets/image-20241229175543723.png" /> </li>
<li>WSS 工作集大小</li>
<li>delta表示什么：间隔定时器的中断频率和工作集的实际变化之间存在时间差</li>
</ul>
</li>
</ul>
<h3 id="allocating-kernel-memory">Allocating Kernel Memory</h3>
<ul>
<li>从空闲内存池中分配，内核代码通常：<ul>
<li>变长分配来减少碎片</li>
<li>分配连续的物理地址</li>
</ul>
</li>
<li>许多系统对与内核代码不使用分页</li>
</ul>
<h2 id="file-system-interfaceok">File System Interface:ok:</h2>
<h3 id="concepts">Concepts</h3>
<ul>
<li>File System Concepts: 控制数据如何在存储介质中存和获取的方式：命名、位置、元数据、访问原则</li>
<li>File Concept: 连续的逻辑地址空间、连续的字节或者行等；类型：数据，程序；</li>
<li>File Structure: None 单词或者字节的顺序、简单的结构（定长、变长）、复杂结构（结构化文档、可重定位文件）</li>
<li>File Attrbutes:名字、唯一标识符、类型、位置、大小、保护、时间等，保存在目录结构中</li>
<li>File Operations: 增删，读写，遍历，</li>
<li>$Open(F_i)$：系统调用，搜索 F 目录项内容移动到内存中</li>
<li>返回一个打开文件表：有两种类型的，per-process table（当前文件指针、访问权限）、System-wide table（打开计数）</li>
<li>管理打开文件的一些数据：文件指针、打开计数、文件磁盘位置(cache of infofrmation)、访问权限等</li>
<li>文件锁：有共享锁和排它锁，有强制性和建议性（建议性的进程可以自己改变锁的状态）</li>
<li>$Close(F_i)$：移动F的目录项从内存到磁盘中的目录结构</li>
</ul>
<h3 id="access-methods">Access Methods</h3>
<ul>
<li>连续访问：rewind， reset， </li>
<li>随机访问/直接访问：index， relative files</li>
</ul>
<h3 id="directory-structureimp">Directory Structure:imp:</h3>
<ul>
<li>可以被看做是 symbol table 符号表</li>
<li>文件系统典型的组成：目录文件 + 文件</li>
<li>对目录的操作：find... , touch ..., </li>
<li>组织目录的来访问要考虑的问题：</li>
<li>Efficiency: 快速访问</li>
<li>Naming: 方便使用</li>
<li>Grouping: 逻辑分组，e.g. Java程序...</li>
<li>单级目录：Syngle-Level Directory</li>
<li>两级目录：Two-Level Directory</li>
<li>树状目录：Tree-Structured Directories</li>
<li>
<p>绝对和相对路径名</p>
</li>
<li>
<p>无环图目录：为了文件的共享，有共享的子目录或文件</p>
</li>
<li>已经存在的文件的指针/link/别名</li>
<li>悬空指针：dangling pointer，解决办法：存着文件的引用？</li>
<li>
<p>新的目录项的类型：连接、Resolve the link可以定位文件</p>
</li>
<li>
<p>一般图目录：因为无环图目录需要别的算法来保证无环</p>
</li>
<li>重复搜索问题、文件删除问题</li>
<li>
<p>只允许link到不是子目录的文件、垃圾回收、使用环检测算法</p>
</li>
<li>
<p><strong>软链接&amp;硬链接</strong> Soft Link vs. Hard Link</p>
</li>
<li>
<p>软链接：是单独的文件、只是指向了原来的文件的路径</p>
<ul>
<li>有自己的FCB，他的数据包含连接到文件的路径</li>
<li>可以扩展文件系统，因为他只是存着文件路径</li>
</ul>
</li>
<li>
<p>硬链接：是对现存文件的别名，他可以提高文件引用计数</p>
<ul>
<li>源文件和硬链接指向相同的FCB</li>
<li>不可以扩展文件系统，不能为目录创建硬链接来阻止无环</li>
</ul>
</li>
</ul>
<h3 id="file-system-mounting">File-System Mounting</h3>
<ul>
<li>文件系统告知有挂在才可以被使用</li>
<li>mount point挂载点</li>
</ul>
<h3 id="file-sharing">File Sharing</h3>
<ul>
<li>多个用户共享文件</li>
<li>分布式系统中共享需要通过网络共享</li>
<li>
<p>NFS网络文件系统，是一个常见的分布式文件共享方法</p>
</li>
<li>
<p>用户ID 标识用户、组ID 方便控制访问权限</p>
</li>
<li>远程文件系统</li>
<li>使用网络：FTP、分布式文件系统、</li>
<li>
<p>使用C-S：客户端-服务器模型 NFS CIFS</p>
</li>
<li>
<p>Failure Modes</p>
</li>
<li>网络故障、服务器故障</li>
<li>
<p>NFS 是无状态协议，请求中包含了所有信息，允许简单的恢复但是更低的安全性</p>
</li>
<li>
<p>一致性语义：AFS/UFS/</p>
</li>
</ul>
<h3 id="protection">Protection</h3>
<ul>
<li>访问类型：读、写、执行......</li>
<li>RWX</li>
<li>通过分组控制权限</li>
</ul>
<h2 id="file-system-implementationok">File System Implementation:ok:</h2>
<h3 id="file-system-structure">File-System Structure</h3>
<ul>
<li>逻辑存储单元、存储相关信息</li>
<li>存在磁盘中</li>
<li>分层组织：</li>
<li><img alt="image-20241213215443801" src="../OS.assets/image-20241213215443801.png" /></li>
<li>磁盘结构：</li>
<li>每一卷：引导控制块BCB</li>
<li>每一卷：卷控制块VCB</li>
<li>每个文件系统：目录结构（文件名在目录项中）</li>
<li>
<p>每个文件：文件控制块FCB（文件权限、时间、大小、指针）</p>
</li>
<li>
<p>内存结构：</p>
</li>
<li>挂载表</li>
<li>目录缓存</li>
<li>系统打开文件表</li>
<li>进程打开文件表</li>
</ul>
<h3 id="virtual-file-system">Virtual File System</h3>
<ul>
<li>
<p>VFS 提供面向对象的实现方式</p>
</li>
<li>
<p>VFS 允许不同的文件系统可以调用相同的API</p>
</li>
<li>
<p>API是对于VFS结构的，不是对不同的文件系统</p>
</li>
<li>
<p>vnode</p>
<p><img alt="image-20241213220404726" src="../OS.assets/image-20241213220404726.png" /></p>
</li>
<li>
<p>VFS四个主要对象：超级块、inode、dentry object、file object</p>
</li>
</ul>
<h3 id="directory-implementation">Directory Implementation</h3>
<ul>
<li>线性链表</li>
<li>哈希表</li>
</ul>
<h3 id="allocation-methodsimp">Allocation Methods:imp:</h3>
<ul>
<li>连续分配</li>
<li>支持随机访问；</li>
<li>浪费空间、不方便改变文件大小</li>
<li>映射计算：LA/512 = Q ... R； 块号：Q，块内偏移：R；</li>
<li>改进：基于extent的系统，extent是连续的块，一个文件包含多个分区</li>
<li>链表分配：</li>
<li>每个文件是块组成的链表，块不一定要连续</li>
<li>不支持随机访问，不可靠</li>
<li>映射计算：LA/511 = Q ... R；块号：Q，块内偏移：R+1；</li>
<li>比尔盖茨：FAT 相当于是文件申请信息的缓存； 快速访问；哈希计算；</li>
<li>索引分配</li>
<li>把所有的指针放到一个索引块中，索引库爱中存放着所有用的块地址</li>
<li>需要索引表，支持随机访问</li>
<li>动态访问没有外部碎片，但是有索引快的额外开销</li>
<li>映射计算：LA/512 = Q ... R；索引块中的位置：Q，数据块中的位置：R；</li>
<li>改进：多级索引</li>
</ul>
<p><img src="OS.assets/image-20250103173428893.png" alt="image-20250103173428893" style="zoom:33%;" /> <img src="OS.assets/image-20250103173451983.png" alt="image-20250103173451983" style="zoom:33%;" /> <img src="OS.assets/image-20250103173511278.png" alt="image-20250103173511278" style="zoom:33%;" /> </p>
<h3 id="free-space-management">Free Space Management</h3>
<ol>
<li>Bit vector (<em>n</em> blocks) bit[i]=1表示为空闲状态 Can get contiguous space easily</li>
<li>Linked list (free list) – see figure Cannot get contiguous space easily</li>
<li>But basically can work (FAT)No waste of space</li>
<li>Grouping – a modification of the Linked List</li>
<li>Addresses of the n free blocks are stored in the first block. </li>
<li>The first n-1 blocks are actually free. The last block contains addressesof another n free blocks</li>
<li>Counting - Address of the first free block and number n contiguous blocks</li>
</ol>
<h3 id="efficiency-and-performance">Efficiency and Performance??</h3>
<p>disk allocation and directory algorithms</p>
<ol>
<li><strong>disk cache</strong> – separate section of main memory for frequently used blocks</li>
<li><strong>free-behind and read-ahead</strong> – techniques to optimize sequential access</li>
<li>improve PC performance by dedicating section of memory as virtual disk, or <strong>RAM disk</strong>.</li>
</ol>
<h2 id="mass-storage-systemsok">Mass-Storage Systems:ok:</h2>
<h3 id="structure-attachment">Structure &amp; Attachment</h3>
<ul>
<li>磁盘结构和相关定义</li>
<li>Track:磁道</li>
<li>Spindle: 主轴</li>
<li>Sector: 扇区（geometrical sector多个扇区组成的扇形区域，track sector扇区）</li>
<li>Cluster: 簇</li>
<li>Cylinder: 柱面</li>
<li>attachment类型：ATA、USB、SCSI(小型计算机系统接口)、SATA、FC</li>
<li>非易失性存储设备Nonvolatile Memory Device：SSD固态硬盘、读写有损耗，寿命有限</li>
<li>网络连接存储：Network-Attached Storage</li>
<li>NAS : 不通过local连接例如总线，而是通过network连接</li>
<li>NFS和CIFS是常见的协议、通过远程procedure calls实现</li>
<li>存储区域网络：在存储网络中比较常见、灵活性高</li>
<li>访问磁盘的时间：</li>
<li>寻道时间seek time，一般1-20ms</li>
<li>旋转时间rotational delay，一般0-10ms</li>
<li>
<p>传输时间transfer time，一般1ms/4KB</p>
</li>
<li>
<p>降低IO的关键：减少寻道时间、旋转时间</p>
</li>
</ul>
<h3 id="imp_1">磁盘调度:imp:</h3>
<ul>
<li>操作系统负责硬件的高效运行，对于磁盘驱动说意味着比较快的访问时间和磁盘带宽</li>
<li>访问时间主要可以从：寻道时间和旋转时间来加速、寻道时间近似于寻道距离seek distance</li>
<li>磁盘带宽指 = 总的传输字节数/到最后一次传输的全部服务时间</li>
<li>算法：request queue，访问的磁道编号（最外面是1号）、距离<ul>
<li>FCFS：先来先服务，</li>
<li>SSTF（Shortest-seek-time-first）：选择距离当前位置最近的磁道，可能<strong>饥饿</strong> </li>
<li>SCAN：从当前开始移动到另一端<strong>尽头</strong>，再反向移动到另一端尽头</li>
<li>LOOK：从当前开始移动到另一端<strong>最后一个任务</strong>，反向移动继续服务其他任务</li>
<li>C-SCAN：提供更平均的等待时间，一直从<strong>起点到终点</strong>，重置到起点，继续单向</li>
<li>C-LOOK：同上，一直单向，移动到<strong>最后一个任务</strong>重置到<strong>第一个任务</strong>，继续单向</li>
</ul>
</li>
<li>选择调度算法：<ul>
<li>SSTF更常见、SCAN C-SCAN在负载重的系统上表现更好</li>
<li>在操作系统中，调度算法应该是一个单独的module，可以选择替换不同算法</li>
<li>一般默认选择SSTF或者LOOK</li>
<li>对于SSD来说最好的调度算法是：先来先服务，因为SSD读写比较快</li>
</ul>
</li>
</ul>
<h3 id="disk-management">Disk Management</h3>
<ul>
<li>格式化：替换连续的磁盘块<ul>
<li>低级格式化low-level formatting/物理格式化：</li>
<li>逻辑格式化physical fromatting：新建一个文件系统</li>
<li>扇区备用处理坏快</li>
</ul>
</li>
<li>引导：MBR主引导分区（引导代码、分区表）</li>
</ul>
<h3 id="swap-space-management">Swap-Space Management</h3>
<ul>
<li>虚拟内存使用磁盘作为物理内存的扩充</li>
<li>两个交换空间的位置：普通的文件系统、单独的磁盘分区</li>
<li>匿名内存</li>
</ul>
<h3 id="raid">RAID 结构</h3>
<ul>
<li>Redundant Arrays of Independent Disk：独立磁盘冗余阵列</li>
<li>RAID 有六种不同的等级<ul>
<li>RAID 0：没有冗余</li>
<li>RAID 1：Mirror</li>
<li>RAID 2：stripes data at the bit-level; uses Hamming code for error correction (not used).</li>
<li>RAID 3：striped across multiple disks, with one dedicated parity disk that stores the parity information of all.</li>
<li>RAID 4：Basically like RAID 3, but interleaving it with strips (blocks)</li>
<li>RAID 5：parity bit 被分散地存到了不同的磁盘里。读写比较均衡。inexpensively reliability</li>
<li>RAID 6：又加了一个 parity bit，也是分散存储。</li>
</ul>
</li>
<li>Mirror：通过冗余提高可靠性<ul>
<li>镜像卷：mirrired volumn；非易失性RAM：NVRAM</li>
</ul>
</li>
<li>Disk striping：通过并行处理提高性能<ul>
<li>Bit-level: 位级分条，改善传输率</li>
<li>Block-level: 文件的快分散在多个磁盘上，磁盘并行，增加吞吐量</li>
</ul>
</li>
<li>RAID(0+1)/RAID(1+0)：0表示分条，1表示镜像<ul>
<li>先镜像在分条比较好：1+0更稳定</li>
</ul>
</li>
</ul>
<h2 id="io-systemsok">I/O Systems:ok:</h2>
<h3 id="hardware">Hardware</h3>
<ul>
<li>常见概念：<ul>
<li>端口: IO设备与PC通信的通道<ul>
<li>用于特殊的IO指令、Memory-mapped IO(设备控制regs映射到进程地址空间)9 </li>
<li>端口寄存器：输入、输出、状态、控制</li>
</ul>
</li>
<li>总线(菊花链daisy chain)：线路+协议，PCI总线、SCSI总线、扩展总线</li>
<li>控制器：SATA、SCSI、SAS controller</li>
</ul>
</li>
<li>程序轮询：Polling<ul>
<li>判断设备的状态：busy/Error/Ready</li>
</ul>
</li>
<li>Interrupts：中断I/O controller<ul>
<li>中断处理器：缺页异常、Trap软件中断</li>
<li>可屏蔽中断 Maskable</li>
<li>六个步骤：</li>
<li><img alt="image-20241227203112846" src="../OS.assets/image-20241227203112846.png" /></li>
</ul>
</li>
<li>DMA：直接内存访问 device controller<ul>
<li>需要DMA控制器</li>
<li>使用可编程IO对于大的数据移动</li>
<li>可以绕过CPU，直接从IO设备传输数据到内存中</li>
<li>六步：</li>
<li><img alt="image-20241227174110606" src="../OS.assets/image-20241227174110606.png" /></li>
</ul>
</li>
</ul>
<h3 id="application-io-interface">Application IO Interface</h3>
<ul>
<li>IO系统调用封装设备的行为</li>
<li>设备驱动层隐藏了kernel中IO控制器的不同，字符流、块、顺序、</li>
<li><strong>设备分类</strong>：<ul>
<li>块设备：磁盘驱动器、<strong>可寻址</strong></li>
<li>字符设备：键盘、鼠标、顺序端口</li>
</ul>
</li>
</ul>
<h3 id="kernel-io-subsystem">Kernel IO Subsystem</h3>
<p><img alt="image-20241227174359036" src="../OS.assets/image-20241227174359036.png" /> </p>
<ul>
<li>网络设备：Unix和系统包含套接字层</li>
<li>时钟和时间：ioctl</li>
<li>阻塞IO和非阻塞IO<ul>
<li>阻塞IO：同步进程</li>
<li>非阻塞IO：异步进程Asynchronous 难以实现</li>
</ul>
</li>
</ul>
<h3 id="io">内核IO子系统</h3>
<ul>
<li>Scheduling：调度</li>
<li>Buffering：缓冲，内存和设置之间的数据传输<ul>
<li>类型：单缓冲、双缓冲、循环缓冲、缓冲池(内存实现)</li>
<li>设备状态表/设备控制表：Device Control Table、DCT</li>
<li>mismatch of speed between modem &amp; disk</li>
<li>mismatch of transfer size</li>
</ul>
</li>
<li>
<p>Caching：高速缓存</p>
<ul>
<li>Always just a copy</li>
<li>Key to performance</li>
</ul>
</li>
<li>
<p>Spooling：假脱机技术hold output for a device</p>
<ul>
<li>在磁盘上面开辟一片空间，将独占设备改造为共享设备，并不是分配真正的物理空间</li>
<li>例如：打印机</li>
</ul>
</li>
<li>
<p>Device reservation：提供设备独占访问exclusive access</p>
<ul>
<li>System calls for allocation and deallocation</li>
<li>Watch out for deadlock</li>
</ul>
</li>
<li>
<p>错误处理：</p>
</li>
<li>IO保护：</li>
<li>数据结构：打开文件表、网络连接、字符设备状态</li>
</ul>
<h3 id="io-request">IO Request</h3>
<ul>
<li>使用系统调用来执行IO</li>
<li>考虑读一个文件的过程：<ul>
<li>判断设备持有的文件（挂载表、磁盘符）</li>
<li>翻译设备表示的名称</li>
<li>从磁盘读取数据到内存</li>
<li>为请求的进程获取可用的数据</li>
<li>把控制权返回给进程</li>
</ul>
</li>
<li><img alt="image-20241227175544269" src="../OS.assets/image-20241227175544269.png" /></li>
</ul>
<h3 id="performance">Performance</h3>
<ul>
<li>IO影响系统性能<ul>
<li>CPU执行设备驱动，内核IO代码</li>
<li>中断引起的上下文切换给CPU带来负担</li>
<li>数据拷贝</li>
<li>网络传输引起压力</li>
</ul>
</li>
<li>提高性能：<ul>
<li>减少上下文切换的次数</li>
<li>减少数据拷贝</li>
<li>减少大文件传输、控制器、轮询引起的中断</li>
<li>使用DMA</li>
<li>平衡CPU、内存、总线、IO性能</li>
</ul>
</li>
</ul>
<h2 id="_23">考试介绍</h2>
<h3 id="_24">待办事项</h3>
<ul>
<li>[ ] JJM老师的作业题选择填空</li>
<li>[ ] XYJ老师的复习课</li>
<li>[ ] HJH学长A4纸整理</li>
<li>[ ] 22-23回忆卷</li>
<li>[ ] 23-24回忆卷</li>
<li>[ ] 王道大题重点的总结</li>
</ul>
<blockquote>
<p>考试：</p>
<ul>
<li>
<p>时间：1.7 10.30-12.30</p>
</li>
<li>
<p>题型：40选择题（写到指定答题卷中） 60分、4个填空题（概念类） 10分、三个问答题 30分</p>
</li>
<li>
<p>内容：有限开卷 A4三张、实验也要复习</p>
</li>
</ul>
<p>复习：</p>
<ol>
<li>第一章：<ol>
<li>OS定义、内核</li>
<li>中断的分类（硬件、软件trap（错误、系统调用））</li>
<li>同步IO、异步IO</li>
<li>设备状态表</li>
<li>存储等级</li>
<li>cache 和 coherency</li>
<li>OS 结构：多道编程、分时系统</li>
<li>OS 操作：用户模式、内核模式、模式的切换</li>
<li>三大管理：进程、内存、存储，IO子系统</li>
</ol>
</li>
<li>第二章：<ol>
<li>OS 服务（区分应用程序提供什么？OS 提供什么？）</li>
<li>系统调用 （API...）:smiling_imp:</li>
<li>设计原则 （mechaniasm, policy）</li>
<li>OS 结构 （分层、宏内核(大而全)、微内核(易于扩展、安全、可靠、开销高)）</li>
</ol>
</li>
<li>第三章：<ol>
<li>进程状态转移：五个状态</li>
<li>进程控制块PCB、上下文切换，哪些信息需要恢复？</li>
<li>进程调度队列：Job Queue、Ready Queue、Device Queue</li>
<li>进程合作：生产者消费者模型，无线缓冲区模型、有限缓冲区模型</li>
</ol>
</li>
<li>第四章<ol>
<li>线程概念，...的最小单位</li>
<li>线程资源，什么是私有的(寄存器和栈)？什么是共享的？</li>
<li>用户级和内核级线程</li>
<li>多线程映射模型：多对一、一对一、多对多</li>
</ol>
</li>
<li>第五章<ol>
<li>CPU调度 ready queue里面的调度，标准：利用率、吞吐量、周转时间、等待时间、响应时间</li>
<li>甘特图</li>
<li>调度的四种情况（14非抢占，23抢占）</li>
<li>FCFS、SJF、Priority、Round Robin、Multilevel、Multi-feedback</li>
<li>优缺点</li>
</ol>
</li>
<li>第六章:kiwi_fruit: <ol>
<li>临界区问题：竞态资源，三个条件</li>
<li>抢占式、非抢占式kernels</li>
<li>软件同步（两个进程 PeterSon、面包房）</li>
<li>硬件指令（Swap, Test&amp;Swap, Compare&amp;Swap）</li>
<li>Semaphone :smiling_imp: 资源释放FIFO</li>
<li>信号量实现：忙等待、非忙等待（阻塞）</li>
<li>两种模型（生产者消费者、读者写者）</li>
</ol>
</li>
<li>第七章<ol>
<li>四种死锁条件：互斥访问、Hold&amp;Wait、无抢占、循环等待</li>
<li>预防：打破四种条件</li>
<li>单实例避免： :smiling_imp: RAG 进程资源分配图与死锁的关系</li>
<li>多实例避免：:smiling_imp: 银行家算法(安全检测算法、资源分配算法) 找到一个资源分配序列 Safty State，复杂度比较高，资源分配释放不够灵活</li>
<li>检测和恢复</li>
</ol>
</li>
<li>第八章<ol>
<li>绑定时间、逻辑/物理地址、三个时刻</li>
<li>MMU，地址转换：逻辑地址-&gt;物理地址 :smiling_imp: </li>
<li>变长划分：动态分区分配、内部碎片（分区内部）、外部碎片（不连续空闲分区）</li>
<li>分页：页表，页表项，多级页表（额外内存访问），快表 TLB，倒置页表</li>
<li>EAT；有效访问时间，包括TLB命中/缺失内存访问时间</li>
<li>分段：段表，页表与段表区别（页表固定）</li>
</ol>
</li>
<li>第九章<ol>
<li>虚拟内存的理解，目的是什么（把物理内存和用户内存分开）</li>
<li>请求式分页、请求式分段</li>
<li>缺页中断，检查页面引用有效，找到页表位置，发送读取请求</li>
<li>页面置换算法：减少缺页次数-页面访问顺序reference string：FIFO（Belady's Anomaly）、optimal最优算法、LRU算法、LRU近似算法（Seconde chance）</li>
<li>抖动 trashing：原因-locality大于物理内存，预防-减少内存的请求，working set</li>
<li>内存映射文件：映射</li>
</ol>
</li>
<li>第十章<ol>
<li>文件系统：如何加载</li>
<li>文件属性：文件控制块 inode</li>
<li>文件操作：打开文件表（系统、进程），访问模式</li>
<li>目录的结构：有效性、命名、Grouping</li>
</ol>
</li>
<li>第十一章<ol>
<li>实现的数据结构：磁盘中四个结构（BCB，VCB，目录，FCB）、内存中四个结构</li>
<li>分配方式：连续、链表、索引</li>
<li>VFS：统一的接口</li>
<li>目录的实现：线性表、哈希表</li>
</ol>
</li>
<li>十二章<ol>
<li>磁盘访问时间：寻道时间+旋转时间+传输时间</li>
<li>磁盘调度算法：FCFS、SSTF、SCAN、C-SCAN、LOOK 、C-LOOK</li>
</ol>
</li>
<li>十三章<ol>
<li>轮询、中断、DMA</li>
<li>阻塞式 IO</li>
<li>设备状态表</li>
<li>Caching, Buffering, </li>
</ol>
</li>
<li>Lab<ol>
<li>Rv-64 实验指导书</li>
<li>常见指令：ls, cp</li>
<li>Trap与 系统调用</li>
</ol>
</li>
</ol>
</blockquote>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.a7c05c9e.min.js"></script>
      
    
  </body>
</html>